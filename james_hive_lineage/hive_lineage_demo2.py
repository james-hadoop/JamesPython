# -*- coding: utf-8 -*-
import json
import os
import sys
import base64

from pyecharts import options as opts
from pyecharts.charts import Graph


def process_lineage_hook_info(lineage):
    data_dict = json.loads(lineage)

    node_set = set()
    nodes_data = []
    links_data = []
    flag = True

    # 所有顶点装入字典
    vertices = data_dict["vertices"]
    vertices_dict = {}
    for elem in vertices:
        key = elem["id"]
        type = elem["vertexType"]
        value = elem["vertexId"]
        vertices_dict[key] = (type, value)

    # 解析边的关系
    i = 100
    j = 100
    edges = data_dict["edges"]
    for elem in edges:
        # print(elem)
        sources = elem["sources"]
        targets = elem["targets"]
        edgeType = elem["edgeType"]
        if "expression" in elem:
            expression = elem["expression"]
        if edgeType == "PROJECTION":
            for source in sources:
                if vertices_dict[source][0] == "COLUMN":
                    origin_column_name = vertices_dict[source][1]
                elif vertices_dict[source][0] == "TABLE":
                    origin_column_name = vertices_dict[source][1] + "." + expression

                for target in targets:
                    if vertices_dict[target][0] == "COLUMN":
                        dest_column_name = vertices_dict[target][1]
                    elif vertices_dict[target][0] == "TABLE":
                        dest_column_name = vertices_dict[target][1] + "." + expression
                    print(
                        f"{origin_column_name} -> {dest_column_name} ->@ {expression} ->@ {base64.decodebytes(str.encode(expression))}")
                    # 图中添加关系
                    if origin_column_name not in node_set:
                        nodes_data.append(
                            opts.GraphNode(name=origin_column_name, symbol_size=10, is_fixed=True, x=100, y=100 + i))
                        node_set.add(origin_column_name)
                        i += 2000

                    if dest_column_name not in node_set:
                        nodes_data.append(
                            opts.GraphNode(name=dest_column_name, symbol_size=10, is_fixed=True, x=20000, y=100 + j))
                        node_set.add(dest_column_name)
                        j += 2000

                    links_data.append(
                        opts.GraphLink(source=origin_column_name, target=dest_column_name,
                                       value=expression))

    # 画图
    c = (
        Graph(init_opts=opts.InitOpts(width="1600px", height="800px"))
            .add(
            "",
            nodes_data,
            links_data,
            repulsion=8000,
            edge_label=opts.LabelOpts(
                is_show=True, position="middle", formatter="{c}"
            )
        )
            .set_global_opts(
            title_opts=opts.TitleOpts(title="hive_lineage_chart")
        )
            .render("hive_lineage_chart.html")
    )


def main():
    line1 = '{"version":"1.0","user":"anonymous","timestamp":1591252758,"duration":11486,"jobIds":["job_local646047722_0001"],"engine":"mr","database":"sng_mp_etldata","hash":"0b357fdc5ac7c2d6f772799d9a0d4a1e","queryText":"INSERT INTO t_video_link_process_by_x_daily_process_caliber SELECT single_quote20200601single_quote AS ftime , from_unixtime(unix_timestamp(single_quote20200601single_quote, single_quoteyyyyMMddsingle_quote), single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS ftime_t , NULL AS is_75_tag, overall_level, content_overall_level, has_qeh_src , NVL(A.short_v, B.short_v) AS short_v, st_src AS src_ch , crawl_src, content_src, union_chann, union_sec_chann , CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END AS is_location, NVL(SUM(input_cnt), 0) AS input_cnt , NVL(SUM(machine_send), 0) AS machine_send , NVL(SUM(machine_duiji), 0) AS machine_duiji , NVL(SUM(machine_cnt), 0) AS machine_cnt , NVL(SUM(machine_pass), 0) AS machine_pass , NVL(SUM(machine_filter), 0) AS machine_filter , NVL(SUM(asn_send), 0) AS asn_send , NVL(SUM(asn_duiji), 0) AS asn_duiji , NVL(SUM(asn_cnt), 0) AS asn_cnt , NVL(SUM(asn_pass), 0) AS asn_pass , NVL(SUM(asn_filter), 0) AS asn_filter , NVL(SUM(st_kd), 0) AS st_kd , NVL(SUM(st_kd_history), 0) AS st_kd_history , NVL(SUM(pop_send), 0) AS pop_send , NVL(SUM(pop_pass), 0) AS pop_pass , NVL(SUM(pop_filter), 0) AS pop_filter , NVL(SUM(allowrecommend), 0) AS allowrecommend , NVL(SUM(in_kandian), 0) AS in_kandian , NVL(SUM(in_liulanqi), 0) AS in_liulanqi , NVL(SUM(in_kuaibao), 0) AS in_kuaibao , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN diaodu_time END), 0) AS diaodu_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN machine_time END), 0) AS machine_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN asn_time END), 0) AS asn_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN all_time END), 0) AS all_time , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND diaodu_time IS NOT NULL) THEN 1 END), 0) AS diaodu_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND machine_time IS NOT NULL) THEN 1 END), 0) AS machine_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND asn_time IS NOT NULL) THEN 1 END), 0) AS asn_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND all_time IS NOT NULL) THEN 1 END), 0) AS all_time_cnt , NVL(SUM(TIME), 0) AS TIME , NVL(SUM(CASE  WHEN TIME IS NOT NULL THEN 1 END), 0) AS time_cnt , single_quote当日入库single_quote AS data_type, send_audit_type FROM ( SELECT * FROM sng_mp_etldata.t_dws_video_chain_inter_daily ) A LEFT JOIN ( SELECT rowkey, in_liulanqi, in_kandian, in_kuaibao , CASE  WHEN content_type = 1 THEN 1 ELSE 0 END AS short_v FROM sanduan_tuijianchi_video_daily_new WHERE f_date = single_quote20200601single_quote ) B ON A.rowkey = B.rowkey LEFT JOIN ( SELECT rowkey, content_overall_level, qeh_location_info FROM t_3t_lsa_video_center_hbase_merged_daily_migrate WHERE imp_date = single_quote20200601single_quote ) C ON A.rowkey = C.rowkey LEFT JOIN ( SELECT rowkey, send_audit_type FROM t_dim_fcc_b_video_rowkey_acc_d WHERE p_date = single_quote20200601single_quote ) D ON A.rowkey = D.rowkey WHERE A.input_date = single_quote20200601single_quote GROUP BY overall_level, content_overall_level, has_qeh_src, NVL(A.short_v, B.short_v), st_src, crawl_src, content_src, union_chann, union_sec_chann, CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END, send_audit_type","edges":[{"sources":[],"targets":[0],"expression":"UDFToLong(single_quote20200601single_quote)","edgeType":"PROJECTION"},{"sources":[],"targets":[1],"expression":"single_quote2020-06-01 00:00:00single_quote","edgeType":"PROJECTION"},{"sources":[],"targets":[2],"expression":"UDFToLong(null)","edgeType":"PROJECTION"},{"sources":[45],"targets":[3],"expression":"UDFToLong(overall_level)","edgeType":"PROJECTION"},{"sources":[46],"targets":[4],"expression":"UDFToLong(content_overall_level)","edgeType":"PROJECTION"},{"sources":[47],"targets":[5],"expression":"UDFToLong(has_qeh_src)","edgeType":"PROJECTION"},{"sources":[48,49],"targets":[6],"expression":"UDFToLong(NVL(t_dws_video_chain_inter_daily.short_v,CASE WHEN ((sanduan_tuijianchi_video_daily_new.content_type = 1)) THEN (1) ELSE (0) END))","edgeType":"PROJECTION"},{"sources":[50],"targets":[7],"edgeType":"PROJECTION"},{"sources":[51],"targets":[8],"edgeType":"PROJECTION"},{"sources":[52],"targets":[9],"edgeType":"PROJECTION"},{"sources":[53],"targets":[10],"edgeType":"PROJECTION"},{"sources":[54],"targets":[11],"edgeType":"PROJECTION"},{"sources":[55],"targets":[12],"expression":"UDFToLong(CASE WHEN ((get_json_object(t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[56],"targets":[13],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.input_cnt),0)","edgeType":"PROJECTION"},{"sources":[57],"targets":[14],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_send),0)","edgeType":"PROJECTION"},{"sources":[58],"targets":[15],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_duiji),0)","edgeType":"PROJECTION"},{"sources":[59],"targets":[16],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_cnt),0)","edgeType":"PROJECTION"},{"sources":[60],"targets":[17],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_pass),0)","edgeType":"PROJECTION"},{"sources":[61],"targets":[18],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_filter),0)","edgeType":"PROJECTION"},{"sources":[62],"targets":[19],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send),0)","edgeType":"PROJECTION"},{"sources":[63],"targets":[20],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_duiji),0)","edgeType":"PROJECTION"},{"sources":[64],"targets":[21],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_cnt),0)","edgeType":"PROJECTION"},{"sources":[65],"targets":[22],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pass),0)","edgeType":"PROJECTION"},{"sources":[66],"targets":[23],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_filter),0)","edgeType":"PROJECTION"},{"sources":[67],"targets":[24],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd),0)","edgeType":"PROJECTION"},{"sources":[68],"targets":[25],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_history),0)","edgeType":"PROJECTION"},{"sources":[69],"targets":[26],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.pop_send),0)","edgeType":"PROJECTION"},{"sources":[70],"targets":[27],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.pop_pass),0)","edgeType":"PROJECTION"},{"sources":[71],"targets":[28],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.pop_filter),0)","edgeType":"PROJECTION"},{"sources":[72],"targets":[29],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.allowrecommend),0)","edgeType":"PROJECTION"},{"sources":[73],"targets":[30],"expression":"NVL(sum(sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kandian),0)","edgeType":"PROJECTION"},{"sources":[74],"targets":[31],"expression":"NVL(sum(sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_liulanqi),0)","edgeType":"PROJECTION"},{"sources":[75],"targets":[32],"expression":"NVL(sum(sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kuaibao),0)","edgeType":"PROJECTION"},{"sources":[76,77,78],"targets":[33],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.diaodu_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,79],"targets":[34],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.machine_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,80],"targets":[35],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.asn_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,81],"targets":[36],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.all_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,78],"targets":[37],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.diaodu_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,79],"targets":[38],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.machine_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,80],"targets":[39],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.asn_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,81],"targets":[40],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.all_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[82],"targets":[41],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.time),0)","edgeType":"PROJECTION"},{"sources":[82],"targets":[42],"expression":"NVL(sum(CASE WHEN (t_dws_video_chain_inter_daily.time is not null) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[],"targets":[43],"expression":"single_quote当日入库single_quote","edgeType":"PROJECTION"},{"sources":[83],"targets":[44],"expression":"UDFToString(send_audit_type)","edgeType":"PROJECTION"},{"sources":[84],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dws_video_chain_inter_daily.input_date = 20200601)","edgeType":"PREDICATE"},{"sources":[85,86,87,88],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dws_video_chain_inter_daily.rowkey = sanduan_tuijianchi_video_daily_new.rowkey AND t_dws_video_chain_inter_daily.rowkey = t_3t_lsa_video_center_hbase_merged_daily_migrate.rowkey AND t_dws_video_chain_inter_daily.rowkey = t_dim_fcc_b_video_rowkey_acc_d.rowkey)","edgeType":"PREDICATE"},{"sources":[89],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(sanduan_tuijianchi_video_daily_new.f_date = 20200601)","edgeType":"PREDICATE"},{"sources":[90],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date = 20200601)","edgeType":"PREDICATE"},{"sources":[91],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dim_fcc_b_video_rowkey_acc_d.p_date = 20200601)","edgeType":"PREDICATE"}],"vertices":[{"id":0,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.ftime"},{"id":1,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.ftime_t"},{"id":2,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.is_75_tag"},{"id":3,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.p_overall_level"},{"id":4,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.content_overall_level"},{"id":5,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.has_qeh_src"},{"id":6,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.short_v"},{"id":7,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.src_ch"},{"id":8,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.crawl_src"},{"id":9,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.content_src"},{"id":10,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.union_chann"},{"id":11,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.union_sec_chann"},{"id":12,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.is_location"},{"id":13,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.input_cnt"},{"id":14,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_send"},{"id":15,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_duiji"},{"id":16,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_cnt"},{"id":17,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_pass"},{"id":18,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_filter"},{"id":19,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_send"},{"id":20,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_duiji"},{"id":21,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_cnt"},{"id":22,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_pass"},{"id":23,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_filter"},{"id":24,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.st_kd"},{"id":25,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.st_kd_history"},{"id":26,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_send"},{"id":27,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_pass"},{"id":28,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_filter"},{"id":29,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.allowrecommend"},{"id":30,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_kandian"},{"id":31,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_liulanqi"},{"id":32,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_kuaibao"},{"id":33,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.diaodu_time"},{"id":34,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_time"},{"id":35,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_time"},{"id":36,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.all_time"},{"id":37,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.diaodu_time_cnt"},{"id":38,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_time_cnt"},{"id":39,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_time_cnt"},{"id":40,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.all_time_cnt"},{"id":41,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.time"},{"id":42,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.time_cnt"},{"id":43,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.data_type"},{"id":44,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.send_audit_type"},{"id":45,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.overall_level"},{"id":46,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.content_overall_level"},{"id":47,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.has_qeh_src"},{"id":48,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.short_v"},{"id":49,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.content_type"},{"id":50,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_src"},{"id":51,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.crawl_src"},{"id":52,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.content_src"},{"id":53,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_chann"},{"id":54,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_sec_chann"},{"id":55,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info"},{"id":56,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_cnt"},{"id":57,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_send"},{"id":58,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_duiji"},{"id":59,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_cnt"},{"id":60,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_pass"},{"id":61,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_filter"},{"id":62,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send"},{"id":63,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_duiji"},{"id":64,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_cnt"},{"id":65,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pass"},{"id":66,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_filter"},{"id":67,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd"},{"id":68,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_history"},{"id":69,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_send"},{"id":70,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_pass"},{"id":71,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_filter"},{"id":72,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.allowrecommend"},{"id":73,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kandian"},{"id":74,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_liulanqi"},{"id":75,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kuaibao"},{"id":76,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.send_asn_time"},{"id":77,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_dispatched_rerun_time"},{"id":78,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.diaodu_time"},{"id":79,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_time"},{"id":80,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_time"},{"id":81,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.all_time"},{"id":82,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.time"},{"id":83,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.send_audit_type"},{"id":84,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_date"},{"id":85,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.rowkey"},{"id":86,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.rowkey"},{"id":87,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.rowkey"},{"id":88,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.rowkey"},{"id":89,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.f_date"},{"id":90,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date"},{"id":91,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.p_date"}]}'
    line2 = '{"version":"1.0","user":"qjiang","timestamp":1591345263,"duration":20788,"jobIds":["job_local1716680902_0001"],"engine":"mr","database":"sng_mp_etldata","hash":"0b357fdc5ac7c2d6f772799d9a0d4a1e","queryText":"INSERT INTO t_video_link_process_by_x_daily_process_caliber SELECT single_quote20200601single_quote AS ftime , from_unixtime(unix_timestamp(single_quote20200601single_quote, single_quoteyyyyMMddsingle_quote), single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS ftime_t , NULL AS is_75_tag, overall_level, content_overall_level, has_qeh_src , NVL(A.short_v, B.short_v) AS short_v, st_src AS src_ch , crawl_src, content_src, union_chann, union_sec_chann , CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END AS is_location, NVL(SUM(input_cnt), 0) AS input_cnt , NVL(SUM(machine_send), 0) AS machine_send , NVL(SUM(machine_duiji), 0) AS machine_duiji , NVL(SUM(machine_cnt), 0) AS machine_cnt , NVL(SUM(machine_pass), 0) AS machine_pass , NVL(SUM(machine_filter), 0) AS machine_filter , NVL(SUM(asn_send), 0) AS asn_send , NVL(SUM(asn_duiji), 0) AS asn_duiji , NVL(SUM(asn_cnt), 0) AS asn_cnt , NVL(SUM(asn_pass), 0) AS asn_pass , NVL(SUM(asn_filter), 0) AS asn_filter , NVL(SUM(st_kd), 0) AS st_kd , NVL(SUM(st_kd_history), 0) AS st_kd_history , NVL(SUM(pop_send), 0) AS pop_send , NVL(SUM(pop_pass), 0) AS pop_pass , NVL(SUM(pop_filter), 0) AS pop_filter , NVL(SUM(allowrecommend), 0) AS allowrecommend , NVL(SUM(in_kandian), 0) AS in_kandian , NVL(SUM(in_liulanqi), 0) AS in_liulanqi , NVL(SUM(in_kuaibao), 0) AS in_kuaibao , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN diaodu_time END), 0) AS diaodu_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN machine_time END), 0) AS machine_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN asn_time END), 0) AS asn_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN all_time END), 0) AS all_time , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND diaodu_time IS NOT NULL) THEN 1 END), 0) AS diaodu_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND machine_time IS NOT NULL) THEN 1 END), 0) AS machine_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND asn_time IS NOT NULL) THEN 1 END), 0) AS asn_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND all_time IS NOT NULL) THEN 1 END), 0) AS all_time_cnt , NVL(SUM(TIME), 0) AS TIME , NVL(SUM(CASE  WHEN TIME IS NOT NULL THEN 1 END), 0) AS time_cnt , single_quote当日入库single_quote AS data_type, send_audit_type FROM ( SELECT * FROM sng_mp_etldata.t_dws_video_chain_inter_daily ) A LEFT JOIN ( SELECT rowkey, in_liulanqi, in_kandian, in_kuaibao , CASE  WHEN content_type = 1 THEN 1 ELSE 0 END AS short_v FROM sanduan_tuijianchi_video_daily_new WHERE f_date = single_quote20200601single_quote ) B ON A.rowkey = B.rowkey LEFT JOIN ( SELECT rowkey, content_overall_level, qeh_location_info FROM t_3t_lsa_video_center_hbase_merged_daily_migrate WHERE imp_date = single_quote20200601single_quote ) C ON A.rowkey = C.rowkey LEFT JOIN ( SELECT rowkey, send_audit_type FROM t_dim_fcc_b_video_rowkey_acc_d WHERE p_date = single_quote20200601single_quote ) D ON A.rowkey = D.rowkey WHERE A.input_date = single_quote20200601single_quote GROUP BY overall_level, content_overall_level, has_qeh_src, NVL(A.short_v, B.short_v), st_src, crawl_src, content_src, union_chann, union_sec_chann, CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END, send_audit_type","edges":[{"sources":[],"targets":[0],"expression":"[B@1bb3e150","edgeType":"PROJECTION"},{"sources":[],"targets":[1],"expression":"[B@6821d4e1","edgeType":"PROJECTION"},{"sources":[],"targets":[2],"expression":"[B@3ac76ad9","edgeType":"PROJECTION"},{"sources":[45],"targets":[3],"expression":"[B@213c812a","edgeType":"PROJECTION"},{"sources":[46],"targets":[4],"expression":"[B@25814d3c","edgeType":"PROJECTION"},{"sources":[47],"targets":[5],"expression":"[B@436103b1","edgeType":"PROJECTION"},{"sources":[48,49],"targets":[6],"expression":"[B@427128a6","edgeType":"PROJECTION"},{"sources":[50],"targets":[7],"edgeType":"PROJECTION"},{"sources":[51],"targets":[8],"edgeType":"PROJECTION"},{"sources":[52],"targets":[9],"edgeType":"PROJECTION"},{"sources":[53],"targets":[10],"edgeType":"PROJECTION"},{"sources":[54],"targets":[11],"edgeType":"PROJECTION"},{"sources":[55],"targets":[12],"expression":"[B@701c413","edgeType":"PROJECTION"},{"sources":[56],"targets":[13],"expression":"[B@28468162","edgeType":"PROJECTION"},{"sources":[57],"targets":[14],"expression":"[B@63f16350","edgeType":"PROJECTION"},{"sources":[58],"targets":[15],"expression":"[B@280e4390","edgeType":"PROJECTION"},{"sources":[59],"targets":[16],"expression":"[B@21262bde","edgeType":"PROJECTION"},{"sources":[60],"targets":[17],"expression":"[B@3df7e309","edgeType":"PROJECTION"},{"sources":[61],"targets":[18],"expression":"[B@55f4ec04","edgeType":"PROJECTION"},{"sources":[62],"targets":[19],"expression":"[B@f3c27e9","edgeType":"PROJECTION"},{"sources":[63],"targets":[20],"expression":"[B@1fd4850b","edgeType":"PROJECTION"},{"sources":[64],"targets":[21],"expression":"[B@1db9d253","edgeType":"PROJECTION"},{"sources":[65],"targets":[22],"expression":"[B@6f5f892c","edgeType":"PROJECTION"},{"sources":[66],"targets":[23],"expression":"[B@1b2e841","edgeType":"PROJECTION"},{"sources":[67],"targets":[24],"expression":"[B@3a75d9a1","edgeType":"PROJECTION"},{"sources":[68],"targets":[25],"expression":"[B@698daff6","edgeType":"PROJECTION"},{"sources":[69],"targets":[26],"expression":"[B@7a085d02","edgeType":"PROJECTION"},{"sources":[70],"targets":[27],"expression":"[B@6cee52e2","edgeType":"PROJECTION"},{"sources":[71],"targets":[28],"expression":"[B@7842260f","edgeType":"PROJECTION"},{"sources":[72],"targets":[29],"expression":"[B@7cb4d4ee","edgeType":"PROJECTION"},{"sources":[73],"targets":[30],"expression":"[B@44ec6637","edgeType":"PROJECTION"},{"sources":[74],"targets":[31],"expression":"[B@5a0b550a","edgeType":"PROJECTION"},{"sources":[75],"targets":[32],"expression":"[B@3390621a","edgeType":"PROJECTION"},{"sources":[76,77,78],"targets":[33],"expression":"[B@69d9d322","edgeType":"PROJECTION"},{"sources":[76,77,79],"targets":[34],"expression":"[B@4e23ddf0","edgeType":"PROJECTION"},{"sources":[76,77,80],"targets":[35],"expression":"[B@4e00723b","edgeType":"PROJECTION"},{"sources":[76,77,81],"targets":[36],"expression":"[B@7e305953","edgeType":"PROJECTION"},{"sources":[76,77,78],"targets":[37],"expression":"[B@59d7d574","edgeType":"PROJECTION"},{"sources":[76,77,79],"targets":[38],"expression":"[B@94b5fe3","edgeType":"PROJECTION"},{"sources":[76,77,80],"targets":[39],"expression":"[B@4417755b","edgeType":"PROJECTION"},{"sources":[76,77,81],"targets":[40],"expression":"[B@3811464b","edgeType":"PROJECTION"},{"sources":[82],"targets":[41],"expression":"[B@5f0a5848","edgeType":"PROJECTION"},{"sources":[82],"targets":[42],"expression":"[B@c6db00d","edgeType":"PROJECTION"},{"sources":[],"targets":[43],"expression":"[B@732fa176","edgeType":"PROJECTION"},{"sources":[83],"targets":[44],"expression":"[B@413e8246","edgeType":"PROJECTION"},{"sources":[84],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"[B@4c7b4a31","edgeType":"PREDICATE"},{"sources":[85,86,87,88],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"[B@2df7766b","edgeType":"PREDICATE"},{"sources":[89],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"[B@235d46b2","edgeType":"PREDICATE"},{"sources":[90],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"[B@1644cc2d","edgeType":"PREDICATE"},{"sources":[91],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"[B@f83616","edgeType":"PREDICATE"}],"vertices":[{"id":0,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.ftime"},{"id":1,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.ftime_t"},{"id":2,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.is_75_tag"},{"id":3,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.p_overall_level"},{"id":4,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.content_overall_level"},{"id":5,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.has_qeh_src"},{"id":6,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.short_v"},{"id":7,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.src_ch"},{"id":8,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.crawl_src"},{"id":9,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.content_src"},{"id":10,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.union_chann"},{"id":11,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.union_sec_chann"},{"id":12,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.is_location"},{"id":13,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.input_cnt"},{"id":14,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_send"},{"id":15,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_duiji"},{"id":16,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_cnt"},{"id":17,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_pass"},{"id":18,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_filter"},{"id":19,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_send"},{"id":20,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_duiji"},{"id":21,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_cnt"},{"id":22,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_pass"},{"id":23,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_filter"},{"id":24,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.st_kd"},{"id":25,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.st_kd_history"},{"id":26,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_send"},{"id":27,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_pass"},{"id":28,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_filter"},{"id":29,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.allowrecommend"},{"id":30,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_kandian"},{"id":31,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_liulanqi"},{"id":32,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_kuaibao"},{"id":33,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.diaodu_time"},{"id":34,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_time"},{"id":35,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_time"},{"id":36,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.all_time"},{"id":37,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.diaodu_time_cnt"},{"id":38,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_time_cnt"},{"id":39,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_time_cnt"},{"id":40,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.all_time_cnt"},{"id":41,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.time"},{"id":42,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.time_cnt"},{"id":43,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.data_type"},{"id":44,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.send_audit_type"},{"id":45,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.overall_level"},{"id":46,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.content_overall_level"},{"id":47,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.has_qeh_src"},{"id":48,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.short_v"},{"id":49,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.content_type"},{"id":50,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_src"},{"id":51,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.crawl_src"},{"id":52,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.content_src"},{"id":53,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_chann"},{"id":54,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_sec_chann"},{"id":55,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info"},{"id":56,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_cnt"},{"id":57,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_send"},{"id":58,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_duiji"},{"id":59,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_cnt"},{"id":60,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_pass"},{"id":61,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_filter"},{"id":62,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send"},{"id":63,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_duiji"},{"id":64,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_cnt"},{"id":65,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pass"},{"id":66,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_filter"},{"id":67,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd"},{"id":68,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_history"},{"id":69,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_send"},{"id":70,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_pass"},{"id":71,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_filter"},{"id":72,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.allowrecommend"},{"id":73,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kandian"},{"id":74,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_liulanqi"},{"id":75,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kuaibao"},{"id":76,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.send_asn_time"},{"id":77,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_dispatched_rerun_time"},{"id":78,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.diaodu_time"},{"id":79,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_time"},{"id":80,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_time"},{"id":81,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.all_time"},{"id":82,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.time"},{"id":83,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.send_audit_type"},{"id":84,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_date"},{"id":85,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.rowkey"},{"id":86,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.rowkey"},{"id":87,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.rowkey"},{"id":88,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.rowkey"},{"id":89,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.f_date"},{"id":90,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date"},{"id":91,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.p_date"}]}'

    line = line2
    print(f"{line}:\n\t")

    print("-" * 160)
    process_lineage_hook_info(line)
    sys.exit(0)


if __name__ == '__main__':
    main()
