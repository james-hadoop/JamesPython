# -*- coding: utf-8 -*-
import json
import os
import sys

from pyecharts import options as opts
from pyecharts.charts import Graph


def process_lineage_hook_info(lineage):
    data_dict = json.loads(lineage)
    os.remove("hive_lineage_chart.html")

    node_set = set()
    nodes_data = []
    links_data = []
    flag = True

    # 所有顶点装入字典
    vertices = data_dict["vertices"]
    vertices_dict = {}
    for elem in vertices:
        key = elem["id"]
        type = elem["vertexType"]
        value = elem["vertexId"]
        vertices_dict[key] = (type, value)

    # 解析边的关系
    i = 100
    j = 100
    edges = data_dict["edges"]
    for elem in edges:
        # print(elem)
        sources = elem["sources"]
        targets = elem["targets"]
        edgeType = elem["edgeType"]
        if "expression" in elem:
            expression = elem["expression"]
        if edgeType == "PROJECTION":
            for source in sources:
                if vertices_dict[source][0] == "COLUMN":
                    origin_column_name = vertices_dict[source][1]
                elif vertices_dict[source][0] == "TABLE":
                    origin_column_name = vertices_dict[source][1] + "." + expression

                for target in targets:
                    if vertices_dict[target][0] == "COLUMN":
                        dest_column_name = vertices_dict[target][1]
                    elif vertices_dict[target][0] == "TABLE":
                        dest_column_name = vertices_dict[target][1] + "." + expression
                    print(f"{origin_column_name} -> {dest_column_name} ->@ {expression}")
                    # 图中添加关系
                    if origin_column_name not in node_set:
                        nodes_data.append(
                            opts.GraphNode(name=origin_column_name, symbol_size=10, is_fixed=True, x=100, y=100 + i))
                        node_set.add(origin_column_name)
                        i += 2000

                    if dest_column_name not in node_set:
                        nodes_data.append(
                            opts.GraphNode(name=dest_column_name, symbol_size=10, is_fixed=True, x=20000, y=100 + j))
                        node_set.add(dest_column_name)
                        j += 2000

                    links_data.append(
                        opts.GraphLink(source=origin_column_name, target=dest_column_name,
                                       value=expression))

    # 画图
    c = (
        Graph(init_opts=opts.InitOpts(width="1600px", height="800px"))
            .add(
            "",
            nodes_data,
            links_data,
            repulsion=8000,
            edge_label=opts.LabelOpts(
                is_show=True, position="middle", formatter="{c}"
            )
        )
            .set_global_opts(
            title_opts=opts.TitleOpts(title="hive_lineage_chart")
        )
            .render("hive_lineage_chart.html")
    )


def main():
    line1 = '{"version":"1.0","user":"anonymous","timestamp":1591242625,"duration":8604,"jobIds":["job_local553650092_0008","job_local474374059_0009"],"engine":"mr","database":"sng_mp_etldata","hash":"3337ef9f349dd772bbdf27f72993eeb2","queryText":"INSERT INTO mydb2.u2 SELECT max(id)*10 AS id, max(name) AS name, max(age)*10 AS age, min(dt) AS dt FROM mydb.u","edges":[{"sources":[4],"targets":[0],"expression":"(max(mydb.u.id) * 10)","edgeType":"PROJECTION"},{"sources":[5],"targets":[1],"expression":"max(mydb.u.name)","edgeType":"PROJECTION"},{"sources":[6],"targets":[2],"expression":"(max(mydb.u.age) * 10)","edgeType":"PROJECTION"},{"sources":[7],"targets":[3],"expression":"min(mydb.u.dt)","edgeType":"PROJECTION"}],"vertices":[{"id":0,"vertexType":"COLUMN","vertexId":"mydb2.u2.u2_id"},{"id":1,"vertexType":"COLUMN","vertexId":"mydb2.u2.u2_name"},{"id":2,"vertexType":"COLUMN","vertexId":"mydb2.u2.u2_age"},{"id":3,"vertexType":"COLUMN","vertexId":"mydb2.u2.u2_dt"},{"id":4,"vertexType":"COLUMN","vertexId":"mydb.u.id"},{"id":5,"vertexType":"COLUMN","vertexId":"mydb.u.name"},{"id":6,"vertexType":"COLUMN","vertexId":"mydb.u.age"},{"id":7,"vertexType":"COLUMN","vertexId":"mydb.u.dt"}]}'
    line2 = '{"version":"1.0","user":"anonymous","timestamp":1591169837,"duration":16956,"jobIds":["job_local1977468677_0003","job_local626406296_0004","job_local23859536_0005"],"engine":"mr","database":"sng_mp_etldata","hash":"72a2edbb6aeabb801a0a216d9bd58806","queryText":"INSERT INTO t_video_link_process_by_x_daily_process_caliber SELECT * FROM ( SELECT single_quote20200601single_quote AS ftime , from_unixtime(unix_timestamp(single_quote20200601single_quote, single_quoteyyyyMMddsingle_quote), single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS ftime_t , NULL AS is_75_tag, overall_level, content_overall_level, has_qeh_src , NVL(A.short_v, B.short_v) AS short_v, st_src AS src_ch , crawl_src, content_src, union_chann, union_sec_chann , CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END AS is_location, NVL(SUM(input_cnt), 0) AS input_cnt , NVL(SUM(machine_send), 0) AS machine_send , NVL(SUM(machine_duiji), 0) AS machine_duiji , NVL(SUM(machine_cnt), 0) AS machine_cnt , NVL(SUM(machine_pass), 0) AS machine_pass , NVL(SUM(machine_filter), 0) AS machine_filter , NVL(SUM(asn_send), 0) AS asn_send , NVL(SUM(asn_duiji), 0) AS asn_duiji , NVL(SUM(asn_cnt), 0) AS asn_cnt , NVL(SUM(asn_pass), 0) AS asn_pass , NVL(SUM(asn_filter), 0) AS asn_filter , NVL(SUM(st_kd), 0) AS st_kd , NVL(SUM(st_kd_history), 0) AS st_kd_history , NVL(SUM(pop_send), 0) AS pop_send , NVL(SUM(pop_pass), 0) AS pop_pass , NVL(SUM(pop_filter), 0) AS pop_filter , NVL(SUM(allowrecommend), 0) AS allowrecommend , NVL(SUM(in_kandian), 0) AS in_kandian , NVL(SUM(in_liulanqi), 0) AS in_liulanqi , NVL(SUM(in_kuaibao), 0) AS in_kuaibao , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN diaodu_time END), 0) AS diaodu_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN machine_time END), 0) AS machine_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN asn_time END), 0) AS asn_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN all_time END), 0) AS all_time , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND diaodu_time IS NOT NULL) THEN 1 END), 0) AS diaodu_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND machine_time IS NOT NULL) THEN 1 END), 0) AS machine_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND asn_time IS NOT NULL) THEN 1 END), 0) AS asn_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND all_time IS NOT NULL) THEN 1 END), 0) AS all_time_cnt , NVL(SUM(TIME), 0) AS TIME , NVL(SUM(CASE  WHEN TIME IS NOT NULL THEN 1 END), 0) AS time_cnt , single_quote当日入库single_quote AS data_type, send_audit_type FROM ( SELECT * FROM t_dws_video_chain_inter_daily ) A LEFT JOIN ( SELECT rowkey, in_liulanqi, in_kandian, in_kuaibao , CASE  WHEN content_type = 1 THEN 1 ELSE 0 END AS short_v FROM sanduan_tuijianchi_video_daily_new WHERE f_date = single_quote20200601single_quote ) B ON A.rowkey = B.rowkey LEFT JOIN ( SELECT rowkey, content_overall_level, qeh_location_info FROM t_3t_lsa_video_center_hbase_merged_daily_migrate WHERE imp_date = single_quote20200601single_quote ) C ON A.rowkey = C.rowkey LEFT JOIN ( SELECT rowkey, send_audit_type FROM t_dim_fcc_b_video_rowkey_acc_d WHERE p_date = single_quote20200601single_quote ) D ON A.rowkey = D.rowkey WHERE A.input_date = single_quote20200601single_quote GROUP BY overall_level, content_overall_level, has_qeh_src, NVL(A.short_v, B.short_v), st_src, crawl_src, content_src, union_chann, union_sec_chann, CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END, send_audit_type UNION ALL SELECT single_quote20200601single_quote AS ftime , from_unixtime(unix_timestamp(single_quote20200601single_quote, single_quoteyyyyMMddsingle_quote), single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS ftime_t , NULL AS is_75_tag, overall_level, content_overall_level, has_qeh_src , NVL(A.short_v, B.short_v) AS short_v, st_src AS src_ch , crawl_src, content_src, union_chann, union_sec_chann , CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END AS is_location, NVL(SUM(input_cnt), 0) AS input_cnt , NVL(SUM(machine_send), 0) AS machine_send , NVL(SUM(machine_duiji), 0) AS machine_duiji , NVL(SUM(machine_cnt), 0) AS machine_cnt , NVL(SUM(machine_pass), 0) AS machine_pass , NVL(SUM(machine_filter), 0) AS machine_filter , NVL(SUM(asn_send), 0) AS asn_send , NVL(SUM(asn_duiji), 0) AS asn_duiji , NVL(SUM(asn_cnt), 0) AS asn_cnt , NVL(SUM(asn_pass), 0) AS asn_pass , NVL(SUM(asn_filter), 0) AS asn_filter , NVL(SUM(st_kd), 0) AS st_kd , NVL(SUM(st_kd_history), 0) AS st_kd_history , NVL(SUM(pop_send), 0) AS pop_send , NVL(SUM(pop_pass), 0) AS pop_pass , NVL(SUM(pop_filter), 0) AS pop_filter , NVL(SUM(allowrecommend), 0) AS allowrecommend , NVL(SUM(in_kandian), 0) AS in_kandian , NVL(SUM(in_liulanqi), 0) AS in_liulanqi , NVL(SUM(in_kuaibao), 0) AS in_kuaibao , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN diaodu_time END), 0) AS diaodu_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN machine_time END), 0) AS machine_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN asn_time END), 0) AS asn_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN all_time END), 0) AS all_time , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND diaodu_time IS NOT NULL) THEN 1 END), 0) AS diaodu_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND machine_time IS NOT NULL) THEN 1 END), 0) AS machine_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND asn_time IS NOT NULL) THEN 1 END), 0) AS asn_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND all_time IS NOT NULL) THEN 1 END), 0) AS all_time_cnt , NVL(SUM(TIME), 0) AS TIME , NVL(SUM(CASE  WHEN TIME IS NOT NULL THEN 1 END), 0) AS time_cnt , single_quote当日处理single_quote AS data_type, send_audit_type FROM ( SELECT * FROM t_dws_video_chain_inter_daily ) A LEFT JOIN ( SELECT rowkey, in_liulanqi, in_kandian, in_kuaibao , CASE  WHEN content_type = 1 THEN 1 ELSE 0 END AS short_v FROM sanduan_tuijianchi_video_daily_new WHERE f_date = single_quote20200601single_quote ) B ON A.rowkey = B.rowkey LEFT JOIN ( SELECT rowkey, content_overall_level, qeh_location_info FROM t_3t_lsa_video_center_hbase_merged_daily_migrate WHERE imp_date = single_quote20200601single_quote ) C ON A.rowkey = C.rowkey LEFT JOIN ( SELECT rowkey, send_audit_type FROM t_dim_fcc_b_video_rowkey_acc_d WHERE p_date = single_quote20200601single_quote ) D ON A.rowkey = D.rowkey WHERE (A.input_date = single_quote20200601single_quote OR A.kv_storage_date = single_quote20200601single_quote OR A.machine_result_date = single_quote20200601single_quote OR A.asn_send_date = single_quote20200601single_quote OR A.asn_result_date = single_quote20200601single_quote OR A.st_kd_date = single_quote20200601single_quote OR A.been_valid_first_date = single_quote20200601single_quote OR A.asn_pop_date = single_quote20200601single_quote OR A.asn_pop_result_date = single_quote20200601single_quote) GROUP BY overall_level, content_overall_level, has_qeh_src, NVL(A.short_v, B.short_v), st_src, crawl_src, content_src, union_chann, union_sec_chann, CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END, send_audit_type ) tt","edges":[{"sources":[],"targets":[0],"expression":"UDFToLong(single_quote20200601single_quote)","edgeType":"PROJECTION"},{"sources":[],"targets":[1],"expression":"single_quote2020-06-01 00:00:00single_quote","edgeType":"PROJECTION"},{"sources":[],"targets":[2],"expression":"UDFToLong(null)","edgeType":"PROJECTION"},{"sources":[45],"targets":[3],"expression":"UDFToLong(tt.ftime)","edgeType":"PROJECTION"},{"sources":[46],"targets":[4],"expression":"UDFToLong(tt.ftime_t)","edgeType":"PROJECTION"},{"sources":[47],"targets":[5],"expression":"UDFToLong(tt.is_75_tag)","edgeType":"PROJECTION"},{"sources":[48,49],"targets":[6],"expression":"UDFToLong(tt.overall_level)","edgeType":"PROJECTION"},{"sources":[50],"targets":[7],"expression":"tt.content_overall_level","edgeType":"PROJECTION"},{"sources":[51],"targets":[8],"expression":"tt.has_qeh_src","edgeType":"PROJECTION"},{"sources":[52],"targets":[9],"expression":"tt.short_v","edgeType":"PROJECTION"},{"sources":[53],"targets":[10],"expression":"tt.src_ch","edgeType":"PROJECTION"},{"sources":[54],"targets":[11],"expression":"tt.crawl_src","edgeType":"PROJECTION"},{"sources":[55],"targets":[12],"expression":"UDFToLong(tt.content_src)","edgeType":"PROJECTION"},{"sources":[56],"targets":[13],"expression":"tt.union_chann","edgeType":"PROJECTION"},{"sources":[57],"targets":[14],"expression":"tt.union_sec_chann","edgeType":"PROJECTION"},{"sources":[58],"targets":[15],"expression":"tt.is_location","edgeType":"PROJECTION"},{"sources":[59],"targets":[16],"expression":"tt.input_cnt","edgeType":"PROJECTION"},{"sources":[60],"targets":[17],"expression":"tt.machine_send","edgeType":"PROJECTION"},{"sources":[61],"targets":[18],"expression":"tt.machine_duiji","edgeType":"PROJECTION"},{"sources":[62],"targets":[19],"expression":"tt.machine_cnt","edgeType":"PROJECTION"},{"sources":[63],"targets":[20],"expression":"tt.machine_pass","edgeType":"PROJECTION"},{"sources":[64],"targets":[21],"expression":"tt.machine_filter","edgeType":"PROJECTION"},{"sources":[65],"targets":[22],"expression":"tt.asn_send","edgeType":"PROJECTION"},{"sources":[66],"targets":[23],"expression":"tt.asn_duiji","edgeType":"PROJECTION"},{"sources":[67],"targets":[24],"expression":"tt.asn_cnt","edgeType":"PROJECTION"},{"sources":[68],"targets":[25],"expression":"tt.asn_pass","edgeType":"PROJECTION"},{"sources":[69],"targets":[26],"expression":"tt.asn_filter","edgeType":"PROJECTION"},{"sources":[70],"targets":[27],"expression":"tt.st_kd","edgeType":"PROJECTION"},{"sources":[71],"targets":[28],"expression":"tt.st_kd_history","edgeType":"PROJECTION"},{"sources":[72],"targets":[29],"expression":"tt.pop_send","edgeType":"PROJECTION"},{"sources":[73],"targets":[30],"expression":"tt.pop_pass","edgeType":"PROJECTION"},{"sources":[74],"targets":[31],"expression":"tt.pop_filter","edgeType":"PROJECTION"},{"sources":[75],"targets":[32],"expression":"tt.allowrecommend","edgeType":"PROJECTION"},{"sources":[76,77,78],"targets":[33],"expression":"tt.in_kandian","edgeType":"PROJECTION"},{"sources":[76,77,79],"targets":[34],"expression":"tt.in_liulanqi","edgeType":"PROJECTION"},{"sources":[76,77,80],"targets":[35],"expression":"tt.in_kuaibao","edgeType":"PROJECTION"},{"sources":[76,77,81],"targets":[36],"expression":"tt.diaodu_time","edgeType":"PROJECTION"},{"sources":[76,77,78],"targets":[37],"expression":"tt.machine_time","edgeType":"PROJECTION"},{"sources":[76,77,79],"targets":[38],"expression":"tt.asn_time","edgeType":"PROJECTION"},{"sources":[76,77,80],"targets":[39],"expression":"tt.all_time","edgeType":"PROJECTION"},{"sources":[76,77,81],"targets":[40],"expression":"tt.diaodu_time_cnt","edgeType":"PROJECTION"},{"sources":[82],"targets":[41],"expression":"tt.machine_time_cnt","edgeType":"PROJECTION"},{"sources":[82],"targets":[42],"expression":"tt.asn_time_cnt","edgeType":"PROJECTION"},{"sources":[],"targets":[43],"expression":"tt.all_time_cnt","edgeType":"PROJECTION"},{"sources":[83],"targets":[44],"expression":"UDFToString(tt.time)","edgeType":"PROJECTION"},{"sources":[84],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dws_video_chain_inter_daily.input_date = 20200601)","edgeType":"PREDICATE"},{"sources":[85,86,87,88],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dws_video_chain_inter_daily.rowkey = sanduan_tuijianchi_video_daily_new.rowkey AND t_dws_video_chain_inter_daily.rowkey = t_3t_lsa_video_center_hbase_merged_daily_migrate.rowkey AND t_dws_video_chain_inter_daily.rowkey = t_dim_fcc_b_video_rowkey_acc_d.rowkey)","edgeType":"PREDICATE"},{"sources":[89],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(sanduan_tuijianchi_video_daily_new.f_date = 20200601)","edgeType":"PREDICATE"},{"sources":[90],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date = 20200601)","edgeType":"PREDICATE"},{"sources":[91],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dim_fcc_b_video_rowkey_acc_d.p_date = 20200601)","edgeType":"PREDICATE"},{"sources":[84,92,93,94,95,96,97,98,99],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"((t_dws_video_chain_inter_daily.input_date = 20200601) or (t_dws_video_chain_inter_daily.kv_storage_date = 20200601) or (t_dws_video_chain_inter_daily.machine_result_date = 20200601) or (t_dws_video_chain_inter_daily.asn_send_date = 20200601) or (t_dws_video_chain_inter_daily.asn_result_date = 20200601) or (t_dws_video_chain_inter_daily.st_kd_date = 20200601) or (t_dws_video_chain_inter_daily.been_valid_first_date = 20200601) or (t_dws_video_chain_inter_daily.asn_pop_date = 20200601) or (t_dws_video_chain_inter_daily.asn_pop_result_date = 20200601))","edgeType":"PREDICATE"}],"vertices":[{"id":0,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.ftime"},{"id":1,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.ftime_t"},{"id":2,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.is_75_tag"},{"id":3,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.p_overall_level"},{"id":4,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.content_overall_level"},{"id":5,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.has_qeh_src"},{"id":6,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.short_v"},{"id":7,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.src_ch"},{"id":8,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.crawl_src"},{"id":9,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.content_src"},{"id":10,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.union_chann"},{"id":11,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.union_sec_chann"},{"id":12,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.is_location"},{"id":13,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.input_cnt"},{"id":14,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_send"},{"id":15,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_duiji"},{"id":16,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_cnt"},{"id":17,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_pass"},{"id":18,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_filter"},{"id":19,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_send"},{"id":20,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_duiji"},{"id":21,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_cnt"},{"id":22,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_pass"},{"id":23,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_filter"},{"id":24,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.st_kd"},{"id":25,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.st_kd_history"},{"id":26,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_send"},{"id":27,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_pass"},{"id":28,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_filter"},{"id":29,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.allowrecommend"},{"id":30,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_kandian"},{"id":31,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_liulanqi"},{"id":32,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_kuaibao"},{"id":33,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.diaodu_time"},{"id":34,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_time"},{"id":35,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_time"},{"id":36,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.all_time"},{"id":37,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.diaodu_time_cnt"},{"id":38,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_time_cnt"},{"id":39,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_time_cnt"},{"id":40,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.all_time_cnt"},{"id":41,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.time"},{"id":42,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.time_cnt"},{"id":43,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.data_type"},{"id":44,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.send_audit_type"},{"id":45,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.overall_level"},{"id":46,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.content_overall_level"},{"id":47,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.has_qeh_src"},{"id":48,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.short_v"},{"id":49,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.content_type"},{"id":50,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_src"},{"id":51,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.crawl_src"},{"id":52,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.content_src"},{"id":53,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_chann"},{"id":54,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_sec_chann"},{"id":55,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info"},{"id":56,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_cnt"},{"id":57,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_send"},{"id":58,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_duiji"},{"id":59,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_cnt"},{"id":60,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_pass"},{"id":61,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_filter"},{"id":62,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send"},{"id":63,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_duiji"},{"id":64,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_cnt"},{"id":65,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pass"},{"id":66,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_filter"},{"id":67,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd"},{"id":68,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_history"},{"id":69,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_send"},{"id":70,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_pass"},{"id":71,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_filter"},{"id":72,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.allowrecommend"},{"id":73,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kandian"},{"id":74,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_liulanqi"},{"id":75,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kuaibao"},{"id":76,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.send_asn_time"},{"id":77,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_dispatched_rerun_time"},{"id":78,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.diaodu_time"},{"id":79,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_time"},{"id":80,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_time"},{"id":81,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.all_time"},{"id":82,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.time"},{"id":83,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.send_audit_type"},{"id":84,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_date"},{"id":85,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.rowkey"},{"id":86,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.rowkey"},{"id":87,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.rowkey"},{"id":88,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.rowkey"},{"id":89,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.f_date"},{"id":90,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date"},{"id":91,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.p_date"},{"id":92,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.kv_storage_date"},{"id":93,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_result_date"},{"id":94,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send_date"},{"id":95,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_result_date"},{"id":96,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_date"},{"id":97,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.been_valid_first_date"},{"id":98,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pop_date"},{"id":99,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pop_result_date"}]}'
    line3 = '{"version":"1.0","user":"anonymous","timestamp":1591099665,"duration":7306,"jobIds":["job_local1591907377_0004"],"engine":"mr","database":"sng_mp_etldata","hash":"c1507264d2bfbb4b7dc4bae7cca4ad77","queryText":"INSERT INTO t_dws_video_chain_inter_daily SELECT /*+mapjoin(B,B2)*/ 20200601 AS f_date, rowkey, st_src, src_ch, crawl_src , crawl_src_ch, content_src, content_src_ch, union_chann, union_chann_id , union_sec_chann, union_sec_chann_id, union_trd_chann, union_trd_chann_id, kd_chann_new , kd_sec_chann_new, short_v, puin, puin_name, media_id , media_name, has_qeh_src, overall_level, p_overall_level, location_prov , location_prov_ch, location_city, location_city_ch, location_dist, location_dist_ch , input_cnt, machine_send, machine_duiji, machine_diaodu_duiji, machine_process_cnt , machine_cnt, machine_pass, machine_filter, boss_send, boss_duiji , boss_cnt, boss_pass, boss_filter, asn_send, asn_duiji , asn_claim_duiji, asn_process_cnt, asn_cnt, asn_pass, asn_filter , asn_filter_without_quchong, quchong, pop_send, pop_pass, pop_filter , pop_first_send_cnt, pop_first_not_claim_cnt, pop_first_claim_not_audit_cnt, pop_first_finish_cnt, pop_first_pass_cnt , pop_first_filter_cnt, pop_sec_send_cnt, pop_sec_not_claim_cnt, pop_sec_claim_not_audit_cnt, pop_sec_finish_cnt , pop_sec_pass_cnt, pop_sec_filter_cnt, st_kd_history, st_kd, reuse , st_kd_sync, st_kd_delete, st_kd_unrecommend, allowrecommend, st_dispatched_rerun_time , diaodu_time, machine_lingdan_time, machine_time, asn_lingdan_time, asn_time , all_time, time, del_id, del_reason, filter_desc , asn_audit_reason, asn_pop_reject_reason, input_date, input_ts_str, kv_storage_modify_ts_str , send_asn_time_str, asn_check_time_str, asn_claim_date, asn_pop_claim_date, asn_pop_date , asn_pop_result_date, asn_result_date, asn_second_pop_claim_date, asn_second_pop_date, asn_second_pop_result_date , asn_send_date, been_valid_first_date, kv_storage_date, machine_process_date, machine_process_start_date , machine_result_date, reuse_date, st_kd_date, send_asn_time, title , url, crawl_ch, expire_time, life_time_hour, xinan_pass , xinan_filter, account_cat, filter_id_new, asn_audit_fail_id, asn_audit_fail_reason , asn_claim_time_str, lingdan_time, filter_id_new_first, filter_desc_first, asn_audit_fail_id_first , asn_audit_fail_reason_first, quchong_asn_audit_pass_cnt, quchong_asn_audit_not_pass_cnt, is_75_low_standard, rpcscore_final , del_id_records, del_reason_records, del_id_first, del_reason_first FROM ( SELECT rowkey, st_src, crawl_src, NULL AS crawl_ch , CASE  WHEN (has_qeh_src = 1 OR has_browser_src = 1 OR has_kuaibao_src = 1) AND nvl(crawl_src, single_quote-1single_quote) NOT IN (single_quote230003single_quote, single_quote230004single_quote) THEN single_quoteqehsingle_quote WHEN crawl_src = single_quote230003single_quote THEN single_quoteqeh-weishisingle_quote WHEN st_src = 48 THEN single_quotehehuorensingle_quote ELSE single_quoteothersingle_quote END AS content_src , CASE  WHEN (has_qeh_src = 1 OR has_browser_src = 1 OR has_kuaibao_src = 1) AND nvl(crawl_src, single_quote-1single_quote) NOT IN (single_quote230003single_quote, single_quote230004single_quote) THEN single_quote企鹅号single_quote WHEN crawl_src = single_quote230003single_quote THEN single_quote企鹅号微视single_quote WHEN st_src = 48 THEN single_quote领域合伙人single_quote ELSE single_quote其他single_quote END AS content_src_ch, union_chann, union_chann_id, union_sec_chann, union_sec_chann_id , union_trd_chann, union_trd_chann_id, kd_chann_new, kd_sec_chann_new, short_v , puin, puin_name, media_id, media_name , CASE  WHEN has_qeh_src = 1 THEN 1 ELSE 0 END AS has_qeh_src, overall_level, NULL AS p_overall_level , get_json_object(qeh_location_info, single_quote$.ProvCodesingle_quote) AS location_prov , get_json_object(qeh_location_info, single_quote$.Provsingle_quote) AS location_prov_ch , get_json_object(qeh_location_info, single_quote$.CityCodesingle_quote) AS location_city , get_json_object(qeh_location_info, single_quote$.Citysingle_quote) AS location_city_ch , get_json_object(qeh_location_info, single_quote$.DistCodesingle_quote) AS location_dist , get_json_object(qeh_location_info, single_quote$.Distsingle_quote) AS location_dist_ch , CASE  WHEN input_ts IS NOT NULL THEN 1 ELSE 0 END AS input_cnt , CASE  WHEN kv_storage = 0 THEN 1 ELSE 0 END AS machine_send , CASE  WHEN kv_storage = 0 AND st_dispatched_start_time IS NULL THEN 1 ELSE 0 END AS machine_duiji , CASE  WHEN kv_storage = 0 AND st_dispatched_start_time IS NULL THEN 1 ELSE 0 END AS machine_diaodu_duiji , CASE  WHEN st_dispatched_start_time IS NOT NULL AND output_ts IS NULL THEN 1 ELSE 0 END AS machine_process_cnt , CASE  WHEN st_sync IN (single_quote1single_quote, single_quote100single_quote) THEN 1 ELSE 0 END AS machine_cnt , CASE  WHEN st_sync = 1 THEN 1 ELSE 0 END AS machine_pass , CASE  WHEN st_sync = 100 THEN 1 ELSE 0 END AS machine_filter , CASE  WHEN st_send_boss = 1 THEN 1 ELSE 0 END AS boss_send , CASE  WHEN st_send_boss = 1 AND NVL(st_boss, 0) != 1 THEN 1 ELSE 0 END AS boss_duiji , CASE  WHEN st_send_boss = 1 AND st_boss = 1 THEN 1 ELSE 0 END AS boss_cnt , CASE  WHEN boss_audit_result = 1 THEN 1 ELSE 0 END AS boss_pass , CASE  WHEN boss_audit_result = 0 THEN 1 ELSE 0 END AS boss_filter , CASE  WHEN st_send_asn = 1 THEN 1 ELSE 0 END AS asn_send , CASE  WHEN st_send_asn = 1 AND NVL(asn_audit_status, 0) != 1 THEN 1 ELSE 0 END AS asn_duiji , CASE  WHEN st_send_asn = 1 AND asn_claim_time IS NULL THEN 1 ELSE 0 END AS asn_claim_duiji , CASE  WHEN asn_claim_time IS NOT NULL AND asn_check_time IS NULL THEN 1 ELSE 0 END AS asn_process_cnt , CASE  WHEN asn_audit_result IN (single_quote1single_quote, single_quote2single_quote) THEN 1 END AS asn_cnt , CASE  WHEN asn_audit_result = 1 THEN 1 ELSE 0 END AS asn_pass , CASE  WHEN asn_audit_result = 2 THEN 1 ELSE 0 END AS asn_filter , CASE  WHEN asn_audit_result = 2 AND asn_audit_fail_id IS NOT NULL THEN 1 ELSE 0 END AS asn_filter_without_quchong , CASE  WHEN asn_audit_reason LIKE single_quote%去重%single_quote THEN 1 ELSE 0 END AS quchong , CASE  WHEN is_asn_pop = 1 THEN 1 ELSE 0 END AS pop_send , CASE  WHEN asn_pop_result = 1 THEN 1 ELSE 0 END AS pop_pass , CASE  WHEN asn_pop_result = 0 THEN 1 ELSE 0 END AS pop_filter , CASE  WHEN is_asn_pop = 1 THEN 1 ELSE 0 END AS pop_first_send_cnt , CASE  WHEN asn_pop_time IS NOT NULL AND asn_pop_claim_time IS NULL THEN 1 ELSE 0 END AS pop_first_not_claim_cnt , CASE  WHEN asn_pop_claim_time IS NOT NULL AND asn_pop_result_time IS NULL THEN 1 ELSE 0 END AS pop_first_claim_not_audit_cnt , CASE  WHEN asn_pop_result = 0 OR asn_pop_result = 1 THEN 1 ELSE 0 END AS pop_first_finish_cnt , CASE  WHEN asn_pop_result = 1 THEN 1 ELSE 0 END AS pop_first_pass_cnt , CASE  WHEN asn_pop_result = 0 THEN 1 ELSE 0 END AS pop_first_filter_cnt , CASE  WHEN asn_pop_second_time IS NOT NULL THEN 1 ELSE 0 END AS pop_sec_send_cnt , CASE  WHEN asn_pop_second_time IS NOT NULL AND asn_pop_second_claim_time IS NULL THEN 1 ELSE 0 END AS pop_sec_not_claim_cnt , CASE  WHEN asn_pop_second_claim_time IS NOT NULL AND asn_pop_second_result_time IS NULL THEN 1 ELSE 0 END AS pop_sec_claim_not_audit_cnt , CASE  WHEN asn_pop_second_result = 0 OR asn_pop_second_result = 1 THEN 1 ELSE 0 END AS pop_sec_finish_cnt , CASE  WHEN asn_pop_second_result = 1 THEN 1 ELSE 0 END AS pop_sec_pass_cnt , CASE  WHEN asn_pop_second_result = 0 THEN 1 ELSE 0 END AS pop_sec_filter_cnt , CASE  WHEN st_kd = 1 OR been_valid = 1 THEN 1 ELSE 0 END AS st_kd_history , CASE  WHEN st_kd = 1 THEN 1 ELSE 0 END AS st_kd , CASE  WHEN reuse = 1 THEN 1 ELSE 0 END AS reuse , CASE  WHEN st_kd_sync = 1 THEN 1 ELSE 0 END AS st_kd_sync , CASE  WHEN enable_to_delete = 1 THEN 1 ELSE 0 END AS st_kd_delete , CASE  WHEN enable_to_unrecommend = 1 THEN 1 ELSE 0 END AS st_kd_unrecommend , CASE  WHEN allowrecommend = 1 THEN 1 ELSE 0 END AS allowrecommend, kv_storage_modify_ts - input_ts AS diaodu_time, st_dispatched_start_time - kv_storage_modify_ts AS machine_lingdan_time , output_ts - st_dispatched_start_time AS machine_time , unix_timestamp(asn_claim_time, single_quoteyyyy-MM-dd HH:mm:sssingle_quote) - send_asn_time AS asn_lingdan_time , asn_check_time - unix_timestamp(asn_claim_time, single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS asn_time , asn_check_time - kv_storage_modify_ts AS all_time , unix_timestamp(asn_claim_time, single_quoteyyyy-MM-dd HH:mm:sssingle_quote) - send_asn_time AS lingdan_time , time, del_id, del_reason , regexp_replace(filter_desc, single_quote,|backflashandn|backflashandnsingle_quote, single_quote;single_quote) AS filter_desc , asn_audit_reason AS asn_audit_reason, asn_pop_reject_reason, from_unixtime(CAST(substr(input_ts, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) AS input_date , from_unixtime(CAST(substr(input_ts, 1, 10) AS bigint), single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS input_ts_str , from_unixtime(CAST(substr(kv_storage_modify_ts, 1, 10) AS bigint), single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS kv_storage_modify_ts_str , from_unixtime(CAST(substr(send_asn_time, 1, 10) AS bigint), single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS send_asn_time_str , from_unixtime(CAST(substr(asn_check_time, 1, 10) AS bigint), single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS asn_check_time_str , regexp_replace(asn_claim_time, single_quote-single_quote, single_quotesingle_quote) AS asn_claim_date , regexp_replace(asn_pop_claim_time, single_quote-single_quote, single_quotesingle_quote) AS asn_pop_claim_date , regexp_replace(asn_pop_time, single_quote-single_quote, single_quotesingle_quote) AS asn_pop_date , regexp_replace(asn_pop_result_time, single_quote-single_quote, single_quotesingle_quote) AS asn_pop_result_date , from_unixtime(CAST(substr(asn_check_time, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) AS asn_result_date , regexp_replace(asn_pop_second_claim_time, single_quote-single_quote, single_quotesingle_quote) AS asn_second_pop_claim_date , regexp_replace(asn_pop_second_time, single_quote-single_quote, single_quotesingle_quote) AS asn_second_pop_date , regexp_replace(asn_pop_second_result_time, single_quote-single_quote, single_quotesingle_quote) AS asn_second_pop_result_date , from_unixtime(CAST(substr(send_asn_time, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) AS asn_send_date , from_unixtime(CAST(substr(been_valid_first_time, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) AS been_valid_first_date , from_unixtime(CAST(substr(kv_storage_modify_ts, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) AS kv_storage_date , from_unixtime(CAST(substr(st_dispatched_start_time, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) AS machine_process_date , from_unixtime(CAST(substr(st_dispatched_start_time, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) AS machine_process_start_date , from_unixtime(CAST(substr(output_ts, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) AS machine_result_date , from_unixtime(CAST(substr(reuse_time, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) AS reuse_date , from_unixtime(CAST(substr(st_kd_last_updated_ts, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) AS st_kd_date, send_asn_time , st_dispatched_rerun_time, title, url, expire_time, life_time_hour , CASE  WHEN st_xinan_v2 = 1 THEN 1 ELSE 0 END AS xinan_pass , CASE  WHEN st_xinan_v2 > 1 THEN 1 ELSE 0 END AS xinan_filter, account_cat, filter_id_new, asn_audit_fail_id, asn_audit_fail_reason , asn_claim_time AS asn_claim_time_str, filter_id_new AS filter_id_new_first, filter_desc AS filter_desc_first, asn_audit_fail_id AS asn_audit_fail_id_first, asn_audit_fail_reason AS asn_audit_fail_reason_first , CASE  WHEN (from_unixtime(CAST(substr(asn_audit_result_last_updated_ts, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) = 20200601 AND asn_audit_status = 1 AND asn_audit_result = 1 AND asn_audit_reason NOT LIKE single_quote%去重%single_quote) THEN 1 ELSE 0 END AS quchong_asn_audit_pass_cnt , CASE  WHEN (from_unixtime(CAST(substr(asn_audit_result_last_updated_ts, 1, 10) AS bigint), single_quoteyyyyMMddsingle_quote) = 20200601 AND asn_audit_status = 1 AND asn_audit_result = 2 AND asn_audit_reason NOT LIKE single_quote%去重%single_quote) THEN 1 ELSE 0 END AS quchong_asn_audit_not_pass_cnt, is_75_low_standard, rpcscore_final, del_id_records, del_reason_records , del_id_records AS del_id_first, del_reason_records AS del_reason_first FROM t_3t_lsa_video_center_hbase_merged_daily_migrate WHERE imp_date = 20200601 ) A LEFT JOIN ( SELECT value, ch_value AS src_ch FROM t_kandian_mapping WHERE f_date = 20200601 AND field = single_quotest_srcsingle_quote ) B ON A.st_src = B.value LEFT JOIN ( SELECT value, ch_value AS crawl_src_ch FROM t_kandian_mapping WHERE f_date = 20200601 AND field = single_quotecrawl_srcsingle_quote ) B2 ON A.crawl_src = B2.value","edges":[{"sources":[],"targets":[0],"expression":"UDFToLong(20200601)","edgeType":"PROJECTION"},{"sources":[134],"targets":[1],"edgeType":"PROJECTION"},{"sources":[135],"targets":[2],"edgeType":"PROJECTION"},{"sources":[136],"targets":[3,4],"edgeType":"PROJECTION"},{"sources":[137],"targets":[5],"edgeType":"PROJECTION"},{"sources":[138,139,140,137,135],"targets":[6],"expression":"CASE WHEN ((((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.has_qeh_src) = 1.0) or (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.has_browser_src) = 1.0) or (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.has_kuaibao_src) = 1.0)) and (not (NVL(t_3t_lsa_video_center_hbase_merged_daily_migrate.crawl_src,single_quote-1single_quote)) IN (single_quote230003single_quote, single_quote230004single_quote)))) THEN (single_quoteqehsingle_quote) WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.crawl_src = single_quote230003single_quote)) THEN (single_quoteqeh-weishisingle_quote) WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_src) = 48.0)) THEN (single_quotehehuorensingle_quote) ELSE (single_quoteothersingle_quote) END","edgeType":"PROJECTION"},{"sources":[138,139,140,137,135],"targets":[7],"expression":"CASE WHEN ((((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.has_qeh_src) = 1.0) or (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.has_browser_src) = 1.0) or (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.has_kuaibao_src) = 1.0)) and (not (NVL(t_3t_lsa_video_center_hbase_merged_daily_migrate.crawl_src,single_quote-1single_quote)) IN (single_quote230003single_quote, single_quote230004single_quote)))) THEN (single_quote企鹅号single_quote) WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.crawl_src = single_quote230003single_quote)) THEN (single_quote企鹅号微视single_quote) WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_src) = 48.0)) THEN (single_quote领域合伙人single_quote) ELSE (single_quote其他single_quote) END","edgeType":"PROJECTION"},{"sources":[141],"targets":[8],"edgeType":"PROJECTION"},{"sources":[142],"targets":[9],"edgeType":"PROJECTION"},{"sources":[143],"targets":[10],"edgeType":"PROJECTION"},{"sources":[144],"targets":[11],"edgeType":"PROJECTION"},{"sources":[145],"targets":[12],"edgeType":"PROJECTION"},{"sources":[146],"targets":[13],"edgeType":"PROJECTION"},{"sources":[147],"targets":[14],"expression":"UDFToLong(kd_chann_new)","edgeType":"PROJECTION"},{"sources":[148],"targets":[15],"expression":"UDFToLong(kd_sec_chann_new)","edgeType":"PROJECTION"},{"sources":[149],"targets":[16],"edgeType":"PROJECTION"},{"sources":[150],"targets":[17],"edgeType":"PROJECTION"},{"sources":[151],"targets":[18],"expression":"UDFToLong(puin_name)","edgeType":"PROJECTION"},{"sources":[152],"targets":[19],"expression":"UDFToLong(media_id)","edgeType":"PROJECTION"},{"sources":[153],"targets":[20],"expression":"UDFToLong(media_name)","edgeType":"PROJECTION"},{"sources":[138],"targets":[21],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.has_qeh_src) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[154],"targets":[22],"expression":"UDFToLong(overall_level)","edgeType":"PROJECTION"},{"sources":[],"targets":[23],"expression":"UDFToLong(null)","edgeType":"PROJECTION"},{"sources":[155],"targets":[24],"expression":"UDFToLong(get_json_object(t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info, single_quote$.ProvCodesingle_quote))","edgeType":"PROJECTION"},{"sources":[155],"targets":[25],"expression":"UDFToLong(get_json_object(t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info, single_quote$.Provsingle_quote))","edgeType":"PROJECTION"},{"sources":[155],"targets":[26],"expression":"UDFToLong(get_json_object(t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info, single_quote$.CityCodesingle_quote))","edgeType":"PROJECTION"},{"sources":[155],"targets":[27],"expression":"UDFToLong(get_json_object(t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info, single_quote$.Citysingle_quote))","edgeType":"PROJECTION"},{"sources":[155],"targets":[28],"expression":"UDFToLong(get_json_object(t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info, single_quote$.DistCodesingle_quote))","edgeType":"PROJECTION"},{"sources":[155],"targets":[29],"expression":"UDFToLong(get_json_object(t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info, single_quote$.Distsingle_quote))","edgeType":"PROJECTION"},{"sources":[156],"targets":[30],"expression":"UDFToLong(CASE WHEN (t_3t_lsa_video_center_hbase_merged_daily_migrate.input_ts is not null) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[157],"targets":[31],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.kv_storage) = 0.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[157,158],"targets":[32,33],"expression":"UDFToLong(CASE WHEN (((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.kv_storage) = 0.0) and t_3t_lsa_video_center_hbase_merged_daily_migrate.st_dispatched_start_time is null)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[158,159],"targets":[34],"expression":"UDFToLong(CASE WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.st_dispatched_start_time is not null and t_3t_lsa_video_center_hbase_merged_daily_migrate.output_ts is null)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[160],"targets":[35],"expression":"UDFToLong(CASE WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.st_sync) IN (single_quote1single_quote, single_quote100single_quote)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[160],"targets":[36],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_sync) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[160],"targets":[37],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_sync) = 100.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[161],"targets":[38],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_send_boss) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[161,162],"targets":[39],"expression":"UDFToLong(CASE WHEN (((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_send_boss) = 1.0) and (UDFToDouble(NVL(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_boss,0)) <> 1.0))) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[161,162],"targets":[40],"expression":"UDFToLong(CASE WHEN (((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_send_boss) = 1.0) and (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_boss) = 1.0))) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[163],"targets":[41],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.boss_audit_result) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[163],"targets":[42],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.boss_audit_result) = 0.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[164],"targets":[43],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_send_asn) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[164,165],"targets":[44],"expression":"UDFToString(CASE WHEN (((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_send_asn) = 1.0) and (UDFToDouble(NVL(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_status,0)) <> 1.0))) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[164,166],"targets":[45],"expression":"UDFToString(CASE WHEN (((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_send_asn) = 1.0) and t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_claim_time is null)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[166,167],"targets":[46],"expression":"UDFToString(CASE WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_claim_time is not null and t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_check_time is null)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[168],"targets":[47],"expression":"UDFToString(CASE WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_result) IN (single_quote1single_quote, single_quote2single_quote)) THEN (1) ELSE (null) END)","edgeType":"PROJECTION"},{"sources":[168],"targets":[48],"expression":"UDFToString(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_result) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[168],"targets":[49],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_result) = 2.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[168,169],"targets":[50],"expression":"UDFToString(CASE WHEN (((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_result) = 2.0) and t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_fail_id is not null)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[170],"targets":[51],"expression":"UDFToString(CASE WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_reason like single_quote%去重%single_quote)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[171],"targets":[52,53],"expression":"UDFToString(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.is_asn_pop) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[172],"targets":[54,55],"expression":"UDFToString(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_result) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[172],"targets":[56,57],"expression":"UDFToString(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_result) = 0.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[173,174],"targets":[58],"expression":"UDFToString(CASE WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_time is not null and t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_claim_time is null)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[174,175],"targets":[59],"expression":"UDFToLong(CASE WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_claim_time is not null and t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_result_time is null)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[172],"targets":[60],"expression":"UDFToString(CASE WHEN (((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_result) = 0.0) or (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_result) = 1.0))) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[176],"targets":[61],"expression":"UDFToString(CASE WHEN (t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_time is not null) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[176,177],"targets":[62],"expression":"UDFToString(CASE WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_time is not null and t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_claim_time is null)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[177,178],"targets":[63],"expression":"UDFToString(CASE WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_claim_time is not null and t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_result_time is null)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[179],"targets":[64],"expression":"UDFToString(CASE WHEN (((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_result) = 0.0) or (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_result) = 1.0))) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[179],"targets":[65],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_result) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[179],"targets":[66],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_result) = 0.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[180,181],"targets":[67],"expression":"UDFToString(CASE WHEN (((t_3t_lsa_video_center_hbase_merged_daily_migrate.st_kd = 1) or (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.been_valid) = 1.0))) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[180],"targets":[68],"expression":"UDFToString(CASE WHEN ((t_3t_lsa_video_center_hbase_merged_daily_migrate.st_kd = 1)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[182],"targets":[69],"expression":"UDFToString(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.reuse) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[183],"targets":[70],"expression":"UDFToString(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_kd_sync) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[184],"targets":[71],"expression":"UDFToString(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.enable_to_delete) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[185],"targets":[72],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.enable_to_unrecommend) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[186],"targets":[73],"expression":"UDFToString(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.allowrecommend) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[187],"targets":[74],"edgeType":"PROJECTION"},{"sources":[188,156],"targets":[75],"expression":"UDFToString((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.kv_storage_modify_ts) - UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.input_ts)))","edgeType":"PROJECTION"},{"sources":[158,188],"targets":[76],"expression":"UDFToString((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_dispatched_start_time) - UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.kv_storage_modify_ts)))","edgeType":"PROJECTION"},{"sources":[159,158],"targets":[77],"expression":"UDFToLong((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.output_ts) - UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_dispatched_start_time)))","edgeType":"PROJECTION"},{"sources":[166,189],"targets":[78,79],"expression":"UDFToLong((UDFToDouble(to_unix_timestamp(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_claim_time,single_quoteyyyy-MM-dd HH:mm:sssingle_quote)) - UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.send_asn_time)))","edgeType":"PROJECTION"},{"sources":[167,166],"targets":[80],"expression":"UDFToString((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_check_time) - UDFToDouble(to_unix_timestamp(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_claim_time,single_quoteyyyy-MM-dd HH:mm:sssingle_quote))))","edgeType":"PROJECTION"},{"sources":[167,188],"targets":[81],"expression":"UDFToString((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_check_time) - UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.kv_storage_modify_ts)))","edgeType":"PROJECTION"},{"sources":[190],"targets":[82],"expression":"UDFToString(time)","edgeType":"PROJECTION"},{"sources":[191],"targets":[83],"edgeType":"PROJECTION"},{"sources":[192],"targets":[84],"edgeType":"PROJECTION"},{"sources":[193],"targets":[85],"expression":"regexp_replace(t_3t_lsa_video_center_hbase_merged_daily_migrate.filter_desc, single_quote,|backflashandn|backflashandnsingle_quote, single_quote;single_quote)","edgeType":"PROJECTION"},{"sources":[170],"targets":[86],"edgeType":"PROJECTION"},{"sources":[194],"targets":[87],"edgeType":"PROJECTION"},{"sources":[156],"targets":[88],"expression":"from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.input_ts, 1, 10)), single_quoteyyyyMMddsingle_quote)","edgeType":"PROJECTION"},{"sources":[156],"targets":[89],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.input_ts, 1, 10)), single_quoteyyyy-MM-dd HH:mm:sssingle_quote))","edgeType":"PROJECTION"},{"sources":[188],"targets":[90],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.kv_storage_modify_ts, 1, 10)), single_quoteyyyy-MM-dd HH:mm:sssingle_quote))","edgeType":"PROJECTION"},{"sources":[189],"targets":[91],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.send_asn_time, 1, 10)), single_quoteyyyy-MM-dd HH:mm:sssingle_quote))","edgeType":"PROJECTION"},{"sources":[167],"targets":[92],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_check_time, 1, 10)), single_quoteyyyy-MM-dd HH:mm:sssingle_quote))","edgeType":"PROJECTION"},{"sources":[166],"targets":[93],"expression":"UDFToLong(regexp_replace(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_claim_time, single_quote-single_quote, single_quotesingle_quote))","edgeType":"PROJECTION"},{"sources":[174],"targets":[94],"expression":"UDFToLong(regexp_replace(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_claim_time, single_quote-single_quote, single_quotesingle_quote))","edgeType":"PROJECTION"},{"sources":[173],"targets":[95],"expression":"UDFToLong(regexp_replace(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_time, single_quote-single_quote, single_quotesingle_quote))","edgeType":"PROJECTION"},{"sources":[175],"targets":[96],"expression":"UDFToLong(regexp_replace(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_result_time, single_quote-single_quote, single_quotesingle_quote))","edgeType":"PROJECTION"},{"sources":[167],"targets":[97],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_check_time, 1, 10)), single_quoteyyyyMMddsingle_quote))","edgeType":"PROJECTION"},{"sources":[177],"targets":[98],"expression":"UDFToLong(regexp_replace(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_claim_time, single_quote-single_quote, single_quotesingle_quote))","edgeType":"PROJECTION"},{"sources":[176],"targets":[99],"expression":"UDFToLong(regexp_replace(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_time, single_quote-single_quote, single_quotesingle_quote))","edgeType":"PROJECTION"},{"sources":[178],"targets":[100],"expression":"UDFToLong(regexp_replace(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_result_time, single_quote-single_quote, single_quotesingle_quote))","edgeType":"PROJECTION"},{"sources":[189],"targets":[101],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.send_asn_time, 1, 10)), single_quoteyyyyMMddsingle_quote))","edgeType":"PROJECTION"},{"sources":[195],"targets":[102],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.been_valid_first_time, 1, 10)), single_quoteyyyyMMddsingle_quote))","edgeType":"PROJECTION"},{"sources":[188],"targets":[103],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.kv_storage_modify_ts, 1, 10)), single_quoteyyyyMMddsingle_quote))","edgeType":"PROJECTION"},{"sources":[158],"targets":[104,105],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_dispatched_start_time, 1, 10)), single_quoteyyyyMMddsingle_quote))","edgeType":"PROJECTION"},{"sources":[159],"targets":[106],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.output_ts, 1, 10)), single_quoteyyyyMMddsingle_quote))","edgeType":"PROJECTION"},{"sources":[196],"targets":[107],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.reuse_time, 1, 10)), single_quoteyyyyMMddsingle_quote))","edgeType":"PROJECTION"},{"sources":[197],"targets":[108],"expression":"UDFToLong(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_kd_last_updated_ts, 1, 10)), single_quoteyyyyMMddsingle_quote))","edgeType":"PROJECTION"},{"sources":[189],"targets":[109],"edgeType":"PROJECTION"},{"sources":[198],"targets":[110],"edgeType":"PROJECTION"},{"sources":[199],"targets":[111],"edgeType":"PROJECTION"},{"sources":[],"targets":[112],"expression":"UDFToString(null)","edgeType":"PROJECTION"},{"sources":[200],"targets":[113],"edgeType":"PROJECTION"},{"sources":[201],"targets":[114],"edgeType":"PROJECTION"},{"sources":[202],"targets":[115],"expression":"UDFToString(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_xinan_v2) = 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[202],"targets":[116],"expression":"UDFToLong(CASE WHEN ((UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_xinan_v2) > 1.0)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[203],"targets":[117],"expression":"UDFToLong(account_cat)","edgeType":"PROJECTION"},{"sources":[204],"targets":[118],"expression":"UDFToLong(filter_id_new)","edgeType":"PROJECTION"},{"sources":[169],"targets":[119],"expression":"UDFToLong(asn_audit_fail_id)","edgeType":"PROJECTION"},{"sources":[205],"targets":[120],"expression":"UDFToLong(asn_audit_fail_reason)","edgeType":"PROJECTION"},{"sources":[166],"targets":[121],"expression":"UDFToLong(asn_claim_time_str)","edgeType":"PROJECTION"},{"sources":[204],"targets":[122],"expression":"UDFToLong(filter_id_new_first)","edgeType":"PROJECTION"},{"sources":[193],"targets":[123],"expression":"UDFToLong(filter_desc_first)","edgeType":"PROJECTION"},{"sources":[169],"targets":[124],"expression":"UDFToLong(asn_audit_fail_id_first)","edgeType":"PROJECTION"},{"sources":[205],"targets":[125],"expression":"UDFToLong(asn_audit_fail_reason_first)","edgeType":"PROJECTION"},{"sources":[206,165,168,170],"targets":[126],"expression":"UDFToLong(CASE WHEN (((UDFToDouble(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_result_last_updated_ts, 1, 10)), single_quoteyyyyMMddsingle_quote)) = 2.0200601E7) and (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_status) = 1.0) and (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_result) = 1.0) and (not (t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_reason like single_quote%去重%single_quote)))) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[206,165,168,170],"targets":[127],"expression":"UDFToLong(CASE WHEN (((UDFToDouble(from_unixtime(UDFToLong(substr(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_result_last_updated_ts, 1, 10)), single_quoteyyyyMMddsingle_quote)) = 2.0200601E7) and (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_status) = 1.0) and (UDFToDouble(t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_result) = 2.0) and (not (t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_reason like single_quote%去重%single_quote)))) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[207],"targets":[128],"expression":"UDFToLong(is_75_low_standard)","edgeType":"PROJECTION"},{"sources":[208],"targets":[129],"expression":"UDFToLong(rpcscore_final)","edgeType":"PROJECTION"},{"sources":[209],"targets":[130],"expression":"UDFToLong(del_id_records)","edgeType":"PROJECTION"},{"sources":[210],"targets":[131],"expression":"UDFToLong(del_reason_records)","edgeType":"PROJECTION"},{"sources":[209],"targets":[132],"expression":"UDFToLong(del_id_first)","edgeType":"PROJECTION"},{"sources":[210],"targets":[133],"edgeType":"PROJECTION"},{"sources":[211],"targets":[0,1,2,3,5,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,56,53,58,59,60,55,57,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,79,122,123,124,125,126,127,128,129,130,131,132,133],"expression":"(t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date = 20200601)","edgeType":"PREDICATE"},{"sources":[135,212],"targets":[0,1,2,3,5,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,56,53,58,59,60,55,57,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,79,122,123,124,125,126,127,128,129,130,131,132,133],"expression":"(t_3t_lsa_video_center_hbase_merged_daily_migrate.st_src = t_kandian_mapping.value)","edgeType":"PREDICATE"},{"sources":[213,214],"targets":[0,1,2,3,5,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,56,53,58,59,60,55,57,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,79,122,123,124,125,126,127,128,129,130,131,132,133],"expression":"((t_kandian_mapping.f_date = 20200601) and (t_kandian_mapping.field = single_quotest_srcsingle_quote))","edgeType":"PREDICATE"},{"sources":[137,212],"targets":[0,1,2,3,5,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,56,53,58,59,60,55,57,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,79,122,123,124,125,126,127,128,129,130,131,132,133],"expression":"(t_3t_lsa_video_center_hbase_merged_daily_migrate.crawl_src = t_kandian_mapping.value)","edgeType":"PREDICATE"},{"sources":[213,214],"targets":[0,1,2,3,5,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,56,53,58,59,60,55,57,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,79,122,123,124,125,126,127,128,129,130,131,132,133],"expression":"((t_kandian_mapping.f_date = 20200601) and (t_kandian_mapping.field = single_quotecrawl_srcsingle_quote))","edgeType":"PREDICATE"}],"vertices":[{"id":0,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.f_date"},{"id":1,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.rowkey"},{"id":2,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_src"},{"id":3,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.src_ch"},{"id":4,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.kd_chann_new"},{"id":5,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.crawl_src"},{"id":6,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.kd_sec_chann_new"},{"id":7,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_chann"},{"id":8,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_sec_chann"},{"id":9,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.short_v"},{"id":10,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.puin"},{"id":11,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.puin_name"},{"id":12,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.media_id"},{"id":13,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.media_name"},{"id":14,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_cnt"},{"id":15,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_send"},{"id":16,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_duiji"},{"id":17,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_cnt"},{"id":18,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_pass"},{"id":19,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_filter"},{"id":20,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.boss_send"},{"id":21,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.boss_duiji"},{"id":22,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.boss_cnt"},{"id":23,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.boss_pass"},{"id":24,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.boss_filter"},{"id":25,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send"},{"id":26,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_duiji"},{"id":27,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_cnt"},{"id":28,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pass"},{"id":29,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_filter"},{"id":30,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.quchong"},{"id":31,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_send"},{"id":32,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_pass"},{"id":33,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_filter"},{"id":34,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_history"},{"id":35,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd"},{"id":36,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_sync"},{"id":37,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.send_asn_time"},{"id":38,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_dispatched_rerun_time"},{"id":39,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.diaodu_time"},{"id":40,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_time"},{"id":41,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_time"},{"id":42,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.all_time"},{"id":43,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.time"},{"id":44,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.del_id"},{"id":45,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.del_reason"},{"id":46,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.filter_desc"},{"id":47,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_audit_reason"},{"id":48,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pop_reject_reason"},{"id":49,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_date"},{"id":50,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_ts_str"},{"id":51,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.kv_storage_modify_ts_str"},{"id":52,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.send_asn_time_str"},{"id":53,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.overall_level"},{"id":54,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_check_time_str"},{"id":55,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.title"},{"id":56,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.has_qeh_src"},{"id":57,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.url"},{"id":58,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.p_overall_level"},{"id":59,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.allowrecommend"},{"id":60,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.content_src"},{"id":61,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_chann_id"},{"id":62,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.crawl_ch"},{"id":63,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.expire_time"},{"id":64,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.life_time_hour"},{"id":65,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.xinan_pass"},{"id":66,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.xinan_filter"},{"id":67,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.account_cat"},{"id":68,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.filter_id_new"},{"id":69,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_audit_fail_id"},{"id":70,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_audit_fail_reason"},{"id":71,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_claim_time_str"},{"id":72,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.lingdan_time"},{"id":73,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.filter_id_new_first"},{"id":74,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.filter_desc_first"},{"id":75,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_audit_fail_id_first"},{"id":76,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_audit_fail_reason_first"},{"id":77,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.quchong_asn_audit_pass_cnt"},{"id":78,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.quchong_asn_audit_not_pass_cnt"},{"id":79,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_first_filter_cnt"},{"id":80,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.is_75_low_standard"},{"id":81,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_sec_chann_id"},{"id":82,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_trd_chann"},{"id":83,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_trd_chann_id"},{"id":84,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.rpcscore_final"},{"id":85,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.del_reason_records"},{"id":86,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.del_id_records"},{"id":87,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.del_reason_first"},{"id":88,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.del_id_first"},{"id":89,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_process_cnt"},{"id":90,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_claim_duiji"},{"id":91,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_process_cnt"},{"id":92,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_delete"},{"id":93,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_unrecommend"},{"id":94,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.kv_storage_date"},{"id":95,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_process_start_date"},{"id":96,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_result_date"},{"id":97,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send_date"},{"id":98,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_claim_date"},{"id":99,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_result_date"},{"id":100,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_date"},{"id":101,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.been_valid_first_date"},{"id":102,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.reuse_date"},{"id":103,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pop_date"},{"id":104,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pop_claim_date"},{"id":105,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pop_result_date"},{"id":106,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_second_pop_date"},{"id":107,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_second_pop_claim_date"},{"id":108,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_second_pop_result_date"},{"id":109,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.location_prov"},{"id":110,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.location_prov_ch"},{"id":111,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.location_city"},{"id":112,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.location_city_ch"},{"id":113,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.location_dist"},{"id":114,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.location_dist_ch"},{"id":115,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.content_src_ch"},{"id":116,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_diaodu_duiji"},{"id":117,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_first_send_cnt"},{"id":118,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_first_not_claim_cnt"},{"id":119,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_first_claim_not_audit_cnt"},{"id":120,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_first_finish_cnt"},{"id":121,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_first_pass_cnt"},{"id":122,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_sec_send_cnt"},{"id":123,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_sec_not_claim_cnt"},{"id":124,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_sec_claim_not_audit_cnt"},{"id":125,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_sec_finish_cnt"},{"id":126,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_sec_pass_cnt"},{"id":127,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_sec_filter_cnt"},{"id":128,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_filter_without_quchong"},{"id":129,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_lingdan_time"},{"id":130,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_lingdan_time"},{"id":131,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_process_date"},{"id":132,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.reuse"},{"id":133,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.crawl_src_ch"},{"id":134,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.rowkey"},{"id":135,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_src"},{"id":136,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kandian_mapping.ch_value"},{"id":137,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.crawl_src"},{"id":138,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.has_qeh_src"},{"id":139,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.has_browser_src"},{"id":140,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.has_kuaibao_src"},{"id":141,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.union_chann"},{"id":142,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.union_chann_id"},{"id":143,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.union_sec_chann"},{"id":144,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.union_sec_chann_id"},{"id":145,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.union_trd_chann"},{"id":146,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.union_trd_chann_id"},{"id":147,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.kd_chann_new"},{"id":148,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.kd_sec_chann_new"},{"id":149,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.short_v"},{"id":150,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.puin"},{"id":151,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.puin_name"},{"id":152,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.media_id"},{"id":153,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.media_name"},{"id":154,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.overall_level"},{"id":155,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info"},{"id":156,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.input_ts"},{"id":157,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.kv_storage"},{"id":158,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_dispatched_start_time"},{"id":159,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.output_ts"},{"id":160,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_sync"},{"id":161,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_send_boss"},{"id":162,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_boss"},{"id":163,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.boss_audit_result"},{"id":164,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_send_asn"},{"id":165,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_status"},{"id":166,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_claim_time"},{"id":167,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_check_time"},{"id":168,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_result"},{"id":169,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_fail_id"},{"id":170,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_reason"},{"id":171,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.is_asn_pop"},{"id":172,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_result"},{"id":173,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_time"},{"id":174,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_claim_time"},{"id":175,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_result_time"},{"id":176,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_time"},{"id":177,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_claim_time"},{"id":178,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_result_time"},{"id":179,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_second_result"},{"id":180,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_kd"},{"id":181,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.been_valid"},{"id":182,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.reuse"},{"id":183,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_kd_sync"},{"id":184,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.enable_to_delete"},{"id":185,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.enable_to_unrecommend"},{"id":186,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.allowrecommend"},{"id":187,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_dispatched_rerun_time"},{"id":188,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.kv_storage_modify_ts"},{"id":189,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.send_asn_time"},{"id":190,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.time"},{"id":191,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.del_id"},{"id":192,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.del_reason"},{"id":193,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.filter_desc"},{"id":194,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_pop_reject_reason"},{"id":195,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.been_valid_first_time"},{"id":196,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.reuse_time"},{"id":197,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_kd_last_updated_ts"},{"id":198,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.title"},{"id":199,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.url"},{"id":200,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.expire_time"},{"id":201,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.life_time_hour"},{"id":202,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.st_xinan_v2"},{"id":203,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.account_cat"},{"id":204,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.filter_id_new"},{"id":205,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_fail_reason"},{"id":206,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.asn_audit_result_last_updated_ts"},{"id":207,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.is_75_low_standard"},{"id":208,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.rpcscore_final"},{"id":209,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.del_id_records"},{"id":210,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.del_reason_records"},{"id":211,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date"},{"id":212,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kandian_mapping.value"},{"id":213,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kandian_mapping.f_date"},{"id":214,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kandian_mapping.field"}]}'
    line4 = '{"version":"1.0","user":"anonymous","timestamp":1591252758,"duration":11486,"jobIds":["job_local646047722_0001"],"engine":"mr","database":"sng_mp_etldata","hash":"0b357fdc5ac7c2d6f772799d9a0d4a1e","queryText":"INSERT INTO t_video_link_process_by_x_daily_process_caliber SELECT single_quote20200601single_quote AS ftime , from_unixtime(unix_timestamp(single_quote20200601single_quote, single_quoteyyyyMMddsingle_quote), single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS ftime_t , NULL AS is_75_tag, overall_level, content_overall_level, has_qeh_src , NVL(A.short_v, B.short_v) AS short_v, st_src AS src_ch , crawl_src, content_src, union_chann, union_sec_chann , CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END AS is_location, NVL(SUM(input_cnt), 0) AS input_cnt , NVL(SUM(machine_send), 0) AS machine_send , NVL(SUM(machine_duiji), 0) AS machine_duiji , NVL(SUM(machine_cnt), 0) AS machine_cnt , NVL(SUM(machine_pass), 0) AS machine_pass , NVL(SUM(machine_filter), 0) AS machine_filter , NVL(SUM(asn_send), 0) AS asn_send , NVL(SUM(asn_duiji), 0) AS asn_duiji , NVL(SUM(asn_cnt), 0) AS asn_cnt , NVL(SUM(asn_pass), 0) AS asn_pass , NVL(SUM(asn_filter), 0) AS asn_filter , NVL(SUM(st_kd), 0) AS st_kd , NVL(SUM(st_kd_history), 0) AS st_kd_history , NVL(SUM(pop_send), 0) AS pop_send , NVL(SUM(pop_pass), 0) AS pop_pass , NVL(SUM(pop_filter), 0) AS pop_filter , NVL(SUM(allowrecommend), 0) AS allowrecommend , NVL(SUM(in_kandian), 0) AS in_kandian , NVL(SUM(in_liulanqi), 0) AS in_liulanqi , NVL(SUM(in_kuaibao), 0) AS in_kuaibao , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN diaodu_time END), 0) AS diaodu_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN machine_time END), 0) AS machine_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN asn_time END), 0) AS asn_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN all_time END), 0) AS all_time , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND diaodu_time IS NOT NULL) THEN 1 END), 0) AS diaodu_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND machine_time IS NOT NULL) THEN 1 END), 0) AS machine_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND asn_time IS NOT NULL) THEN 1 END), 0) AS asn_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND all_time IS NOT NULL) THEN 1 END), 0) AS all_time_cnt , NVL(SUM(TIME), 0) AS TIME , NVL(SUM(CASE  WHEN TIME IS NOT NULL THEN 1 END), 0) AS time_cnt , single_quote当日入库single_quote AS data_type, send_audit_type FROM ( SELECT * FROM sng_mp_etldata.t_dws_video_chain_inter_daily ) A LEFT JOIN ( SELECT rowkey, in_liulanqi, in_kandian, in_kuaibao , CASE  WHEN content_type = 1 THEN 1 ELSE 0 END AS short_v FROM sanduan_tuijianchi_video_daily_new WHERE f_date = single_quote20200601single_quote ) B ON A.rowkey = B.rowkey LEFT JOIN ( SELECT rowkey, content_overall_level, qeh_location_info FROM t_3t_lsa_video_center_hbase_merged_daily_migrate WHERE imp_date = single_quote20200601single_quote ) C ON A.rowkey = C.rowkey LEFT JOIN ( SELECT rowkey, send_audit_type FROM t_dim_fcc_b_video_rowkey_acc_d WHERE p_date = single_quote20200601single_quote ) D ON A.rowkey = D.rowkey WHERE A.input_date = single_quote20200601single_quote GROUP BY overall_level, content_overall_level, has_qeh_src, NVL(A.short_v, B.short_v), st_src, crawl_src, content_src, union_chann, union_sec_chann, CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END, send_audit_type","edges":[{"sources":[],"targets":[0],"expression":"UDFToLong(single_quote20200601single_quote)","edgeType":"PROJECTION"},{"sources":[],"targets":[1],"expression":"single_quote2020-06-01 00:00:00single_quote","edgeType":"PROJECTION"},{"sources":[],"targets":[2],"expression":"UDFToLong(null)","edgeType":"PROJECTION"},{"sources":[45],"targets":[3],"expression":"UDFToLong(overall_level)","edgeType":"PROJECTION"},{"sources":[46],"targets":[4],"expression":"UDFToLong(content_overall_level)","edgeType":"PROJECTION"},{"sources":[47],"targets":[5],"expression":"UDFToLong(has_qeh_src)","edgeType":"PROJECTION"},{"sources":[48,49],"targets":[6],"expression":"UDFToLong(NVL(t_dws_video_chain_inter_daily.short_v,CASE WHEN ((sanduan_tuijianchi_video_daily_new.content_type = 1)) THEN (1) ELSE (0) END))","edgeType":"PROJECTION"},{"sources":[50],"targets":[7],"edgeType":"PROJECTION"},{"sources":[51],"targets":[8],"edgeType":"PROJECTION"},{"sources":[52],"targets":[9],"edgeType":"PROJECTION"},{"sources":[53],"targets":[10],"edgeType":"PROJECTION"},{"sources":[54],"targets":[11],"edgeType":"PROJECTION"},{"sources":[55],"targets":[12],"expression":"UDFToLong(CASE WHEN ((get_json_object(t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[56],"targets":[13],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.input_cnt),0)","edgeType":"PROJECTION"},{"sources":[57],"targets":[14],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_send),0)","edgeType":"PROJECTION"},{"sources":[58],"targets":[15],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_duiji),0)","edgeType":"PROJECTION"},{"sources":[59],"targets":[16],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_cnt),0)","edgeType":"PROJECTION"},{"sources":[60],"targets":[17],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_pass),0)","edgeType":"PROJECTION"},{"sources":[61],"targets":[18],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_filter),0)","edgeType":"PROJECTION"},{"sources":[62],"targets":[19],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send),0)","edgeType":"PROJECTION"},{"sources":[63],"targets":[20],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_duiji),0)","edgeType":"PROJECTION"},{"sources":[64],"targets":[21],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_cnt),0)","edgeType":"PROJECTION"},{"sources":[65],"targets":[22],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pass),0)","edgeType":"PROJECTION"},{"sources":[66],"targets":[23],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_filter),0)","edgeType":"PROJECTION"},{"sources":[67],"targets":[24],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd),0)","edgeType":"PROJECTION"},{"sources":[68],"targets":[25],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_history),0)","edgeType":"PROJECTION"},{"sources":[69],"targets":[26],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.pop_send),0)","edgeType":"PROJECTION"},{"sources":[70],"targets":[27],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.pop_pass),0)","edgeType":"PROJECTION"},{"sources":[71],"targets":[28],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.pop_filter),0)","edgeType":"PROJECTION"},{"sources":[72],"targets":[29],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.allowrecommend),0)","edgeType":"PROJECTION"},{"sources":[73],"targets":[30],"expression":"NVL(sum(sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kandian),0)","edgeType":"PROJECTION"},{"sources":[74],"targets":[31],"expression":"NVL(sum(sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_liulanqi),0)","edgeType":"PROJECTION"},{"sources":[75],"targets":[32],"expression":"NVL(sum(sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kuaibao),0)","edgeType":"PROJECTION"},{"sources":[76,77,78],"targets":[33],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.diaodu_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,79],"targets":[34],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.machine_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,80],"targets":[35],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.asn_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,81],"targets":[36],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.all_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,78],"targets":[37],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.diaodu_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,79],"targets":[38],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.machine_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,80],"targets":[39],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.asn_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,81],"targets":[40],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.all_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[82],"targets":[41],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.time),0)","edgeType":"PROJECTION"},{"sources":[82],"targets":[42],"expression":"NVL(sum(CASE WHEN (t_dws_video_chain_inter_daily.time is not null) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[],"targets":[43],"expression":"single_quote当日入库single_quote","edgeType":"PROJECTION"},{"sources":[83],"targets":[44],"expression":"UDFToString(send_audit_type)","edgeType":"PROJECTION"},{"sources":[84],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dws_video_chain_inter_daily.input_date = 20200601)","edgeType":"PREDICATE"},{"sources":[85,86,87,88],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dws_video_chain_inter_daily.rowkey = sanduan_tuijianchi_video_daily_new.rowkey AND t_dws_video_chain_inter_daily.rowkey = t_3t_lsa_video_center_hbase_merged_daily_migrate.rowkey AND t_dws_video_chain_inter_daily.rowkey = t_dim_fcc_b_video_rowkey_acc_d.rowkey)","edgeType":"PREDICATE"},{"sources":[89],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(sanduan_tuijianchi_video_daily_new.f_date = 20200601)","edgeType":"PREDICATE"},{"sources":[90],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date = 20200601)","edgeType":"PREDICATE"},{"sources":[91],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dim_fcc_b_video_rowkey_acc_d.p_date = 20200601)","edgeType":"PREDICATE"}],"vertices":[{"id":0,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.ftime"},{"id":1,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.ftime_t"},{"id":2,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.is_75_tag"},{"id":3,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.p_overall_level"},{"id":4,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.content_overall_level"},{"id":5,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.has_qeh_src"},{"id":6,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.short_v"},{"id":7,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.src_ch"},{"id":8,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.crawl_src"},{"id":9,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.content_src"},{"id":10,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.union_chann"},{"id":11,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.union_sec_chann"},{"id":12,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.is_location"},{"id":13,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.input_cnt"},{"id":14,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_send"},{"id":15,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_duiji"},{"id":16,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_cnt"},{"id":17,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_pass"},{"id":18,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_filter"},{"id":19,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_send"},{"id":20,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_duiji"},{"id":21,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_cnt"},{"id":22,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_pass"},{"id":23,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_filter"},{"id":24,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.st_kd"},{"id":25,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.st_kd_history"},{"id":26,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_send"},{"id":27,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_pass"},{"id":28,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_filter"},{"id":29,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.allowrecommend"},{"id":30,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_kandian"},{"id":31,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_liulanqi"},{"id":32,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_kuaibao"},{"id":33,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.diaodu_time"},{"id":34,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_time"},{"id":35,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_time"},{"id":36,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.all_time"},{"id":37,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.diaodu_time_cnt"},{"id":38,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_time_cnt"},{"id":39,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_time_cnt"},{"id":40,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.all_time_cnt"},{"id":41,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.time"},{"id":42,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.time_cnt"},{"id":43,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.data_type"},{"id":44,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.send_audit_type"},{"id":45,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.overall_level"},{"id":46,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.content_overall_level"},{"id":47,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.has_qeh_src"},{"id":48,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.short_v"},{"id":49,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.content_type"},{"id":50,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_src"},{"id":51,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.crawl_src"},{"id":52,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.content_src"},{"id":53,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_chann"},{"id":54,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_sec_chann"},{"id":55,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info"},{"id":56,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_cnt"},{"id":57,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_send"},{"id":58,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_duiji"},{"id":59,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_cnt"},{"id":60,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_pass"},{"id":61,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_filter"},{"id":62,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send"},{"id":63,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_duiji"},{"id":64,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_cnt"},{"id":65,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pass"},{"id":66,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_filter"},{"id":67,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd"},{"id":68,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_history"},{"id":69,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_send"},{"id":70,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_pass"},{"id":71,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_filter"},{"id":72,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.allowrecommend"},{"id":73,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kandian"},{"id":74,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_liulanqi"},{"id":75,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kuaibao"},{"id":76,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.send_asn_time"},{"id":77,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_dispatched_rerun_time"},{"id":78,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.diaodu_time"},{"id":79,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_time"},{"id":80,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_time"},{"id":81,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.all_time"},{"id":82,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.time"},{"id":83,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.send_audit_type"},{"id":84,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_date"},{"id":85,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.rowkey"},{"id":86,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.rowkey"},{"id":87,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.rowkey"},{"id":88,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.rowkey"},{"id":89,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.f_date"},{"id":90,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date"},{"id":91,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.p_date"}]}'

    line = line4
    print(f"{line}:\n\t")

    print("-" * 160)
    process_lineage_hook_info(line)
    sys.exit(0)


if __name__ == '__main__':
    main()
