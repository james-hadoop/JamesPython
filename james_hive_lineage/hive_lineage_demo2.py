# -*- coding: utf-8 -*-
import json
import os
import re
import sys
import base64

from pyecharts import options as opts
from pyecharts.charts import Graph


def process_lineage_hook_info(lineage):
    clean_lineage=re.sub('[\s+]', '', lineage)
    data_dict = json.loads(clean_lineage)

    node_set = set()
    nodes_data = []
    links_data = []
    flag = True

    # 所有顶点装入字典
    vertices = data_dict["vertices"]
    vertices_dict = {}
    for elem in vertices:
        key = elem["id"]
        type = elem["vertexType"]
        value = elem["vertexId"]
        vertices_dict[key] = (type, value)

    # 解析边的关系
    i = 100
    j = 100
    edges = data_dict["edges"]
    for elem in edges:
        # print(elem)
        sources = elem["sources"]
        targets = elem["targets"]
        edgeType = elem["edgeType"]
        if "expression" in elem:
            expression = elem["expression"]
        if edgeType == "PROJECTION":
            for source in sources:
                if vertices_dict[source][0] == "COLUMN":
                    origin_column_name = vertices_dict[source][1]
                elif vertices_dict[source][0] == "TABLE":
                    origin_column_name = vertices_dict[source][1] + "." + expression

                for target in targets:
                    if vertices_dict[target][0] == "COLUMN":
                        dest_column_name = vertices_dict[target][1]
                    elif vertices_dict[target][0] == "TABLE":
                        dest_column_name = vertices_dict[target][1] + "." + expression

                    str_expression = base64.decodebytes(expression.encode()).decode('utf-8')
                    print(
                        f"{origin_column_name} -> {dest_column_name} ->@ {str_expression}")
                    # 图中添加关系
                    if origin_column_name not in node_set:
                        nodes_data.append(
                            opts.GraphNode(name=origin_column_name, symbol_size=10, is_fixed=True, x=100, y=100 + i))
                        node_set.add(origin_column_name)
                        i += 2000

                    if dest_column_name not in node_set:
                        nodes_data.append(
                            opts.GraphNode(name=dest_column_name, symbol_size=10, is_fixed=True, x=20000, y=100 + j))
                        node_set.add(dest_column_name)
                        j += 2000

                    links_data.append(
                        opts.GraphLink(source=origin_column_name, target=dest_column_name,
                                       value=expression))

    # 画图
    c = (
        Graph(init_opts=opts.InitOpts(width="1600px", height="800px"))
            .add(
            "",
            nodes_data,
            links_data,
            repulsion=8000,
            edge_label=opts.LabelOpts(
                is_show=True, position="middle", formatter="{c}"
            )
        )
            .set_global_opts(
            title_opts=opts.TitleOpts(title="hive_lineage_chart")
        )
            .render("hive_lineage_chart.html")
    )


def main():
    line1 = '{"version":"1.0","user":"anonymous","timestamp":1591252758,"duration":11486,"jobIds":["job_local646047722_0001"],"engine":"mr","database":"sng_mp_etldata","hash":"0b357fdc5ac7c2d6f772799d9a0d4a1e","queryText":"INSERT INTO t_video_link_process_by_x_daily_process_caliber SELECT single_quote20200601single_quote AS ftime , from_unixtime(unix_timestamp(single_quote20200601single_quote, single_quoteyyyyMMddsingle_quote), single_quoteyyyy-MM-dd HH:mm:sssingle_quote) AS ftime_t , NULL AS is_75_tag, overall_level, content_overall_level, has_qeh_src , NVL(A.short_v, B.short_v) AS short_v, st_src AS src_ch , crawl_src, content_src, union_chann, union_sec_chann , CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END AS is_location, NVL(SUM(input_cnt), 0) AS input_cnt , NVL(SUM(machine_send), 0) AS machine_send , NVL(SUM(machine_duiji), 0) AS machine_duiji , NVL(SUM(machine_cnt), 0) AS machine_cnt , NVL(SUM(machine_pass), 0) AS machine_pass , NVL(SUM(machine_filter), 0) AS machine_filter , NVL(SUM(asn_send), 0) AS asn_send , NVL(SUM(asn_duiji), 0) AS asn_duiji , NVL(SUM(asn_cnt), 0) AS asn_cnt , NVL(SUM(asn_pass), 0) AS asn_pass , NVL(SUM(asn_filter), 0) AS asn_filter , NVL(SUM(st_kd), 0) AS st_kd , NVL(SUM(st_kd_history), 0) AS st_kd_history , NVL(SUM(pop_send), 0) AS pop_send , NVL(SUM(pop_pass), 0) AS pop_pass , NVL(SUM(pop_filter), 0) AS pop_filter , NVL(SUM(allowrecommend), 0) AS allowrecommend , NVL(SUM(in_kandian), 0) AS in_kandian , NVL(SUM(in_liulanqi), 0) AS in_liulanqi , NVL(SUM(in_kuaibao), 0) AS in_kuaibao , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN diaodu_time END), 0) AS diaodu_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN machine_time END), 0) AS machine_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN asn_time END), 0) AS asn_time , NVL(SUM(CASE  WHEN send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL THEN all_time END), 0) AS all_time , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND diaodu_time IS NOT NULL) THEN 1 END), 0) AS diaodu_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND machine_time IS NOT NULL) THEN 1 END), 0) AS machine_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND asn_time IS NOT NULL) THEN 1 END), 0) AS asn_time_cnt , NVL(SUM(CASE  WHEN (send_asn_time IS NOT NULL AND st_dispatched_rerun_time IS NULL AND all_time IS NOT NULL) THEN 1 END), 0) AS all_time_cnt , NVL(SUM(TIME), 0) AS TIME , NVL(SUM(CASE  WHEN TIME IS NOT NULL THEN 1 END), 0) AS time_cnt , single_quote当日入库single_quote AS data_type, send_audit_type FROM ( SELECT * FROM sng_mp_etldata.t_dws_video_chain_inter_daily ) A LEFT JOIN ( SELECT rowkey, in_liulanqi, in_kandian, in_kuaibao , CASE  WHEN content_type = 1 THEN 1 ELSE 0 END AS short_v FROM sanduan_tuijianchi_video_daily_new WHERE f_date = single_quote20200601single_quote ) B ON A.rowkey = B.rowkey LEFT JOIN ( SELECT rowkey, content_overall_level, qeh_location_info FROM t_3t_lsa_video_center_hbase_merged_daily_migrate WHERE imp_date = single_quote20200601single_quote ) C ON A.rowkey = C.rowkey LEFT JOIN ( SELECT rowkey, send_audit_type FROM t_dim_fcc_b_video_rowkey_acc_d WHERE p_date = single_quote20200601single_quote ) D ON A.rowkey = D.rowkey WHERE A.input_date = single_quote20200601single_quote GROUP BY overall_level, content_overall_level, has_qeh_src, NVL(A.short_v, B.short_v), st_src, crawl_src, content_src, union_chann, union_sec_chann, CASE  WHEN get_json_object(qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote THEN 1 ELSE 0 END, send_audit_type","edges":[{"sources":[],"targets":[0],"expression":"UDFToLong(single_quote20200601single_quote)","edgeType":"PROJECTION"},{"sources":[],"targets":[1],"expression":"single_quote2020-06-01 00:00:00single_quote","edgeType":"PROJECTION"},{"sources":[],"targets":[2],"expression":"UDFToLong(null)","edgeType":"PROJECTION"},{"sources":[45],"targets":[3],"expression":"UDFToLong(overall_level)","edgeType":"PROJECTION"},{"sources":[46],"targets":[4],"expression":"UDFToLong(content_overall_level)","edgeType":"PROJECTION"},{"sources":[47],"targets":[5],"expression":"UDFToLong(has_qeh_src)","edgeType":"PROJECTION"},{"sources":[48,49],"targets":[6],"expression":"UDFToLong(NVL(t_dws_video_chain_inter_daily.short_v,CASE WHEN ((sanduan_tuijianchi_video_daily_new.content_type = 1)) THEN (1) ELSE (0) END))","edgeType":"PROJECTION"},{"sources":[50],"targets":[7],"edgeType":"PROJECTION"},{"sources":[51],"targets":[8],"edgeType":"PROJECTION"},{"sources":[52],"targets":[9],"edgeType":"PROJECTION"},{"sources":[53],"targets":[10],"edgeType":"PROJECTION"},{"sources":[54],"targets":[11],"edgeType":"PROJECTION"},{"sources":[55],"targets":[12],"expression":"UDFToLong(CASE WHEN ((get_json_object(t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info, single_quote$.IsLocationsingle_quote) = single_quotetruesingle_quote)) THEN (1) ELSE (0) END)","edgeType":"PROJECTION"},{"sources":[56],"targets":[13],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.input_cnt),0)","edgeType":"PROJECTION"},{"sources":[57],"targets":[14],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_send),0)","edgeType":"PROJECTION"},{"sources":[58],"targets":[15],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_duiji),0)","edgeType":"PROJECTION"},{"sources":[59],"targets":[16],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_cnt),0)","edgeType":"PROJECTION"},{"sources":[60],"targets":[17],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_pass),0)","edgeType":"PROJECTION"},{"sources":[61],"targets":[18],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.machine_filter),0)","edgeType":"PROJECTION"},{"sources":[62],"targets":[19],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send),0)","edgeType":"PROJECTION"},{"sources":[63],"targets":[20],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_duiji),0)","edgeType":"PROJECTION"},{"sources":[64],"targets":[21],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_cnt),0)","edgeType":"PROJECTION"},{"sources":[65],"targets":[22],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pass),0)","edgeType":"PROJECTION"},{"sources":[66],"targets":[23],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.asn_filter),0)","edgeType":"PROJECTION"},{"sources":[67],"targets":[24],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd),0)","edgeType":"PROJECTION"},{"sources":[68],"targets":[25],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_history),0)","edgeType":"PROJECTION"},{"sources":[69],"targets":[26],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.pop_send),0)","edgeType":"PROJECTION"},{"sources":[70],"targets":[27],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.pop_pass),0)","edgeType":"PROJECTION"},{"sources":[71],"targets":[28],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.pop_filter),0)","edgeType":"PROJECTION"},{"sources":[72],"targets":[29],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.allowrecommend),0)","edgeType":"PROJECTION"},{"sources":[73],"targets":[30],"expression":"NVL(sum(sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kandian),0)","edgeType":"PROJECTION"},{"sources":[74],"targets":[31],"expression":"NVL(sum(sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_liulanqi),0)","edgeType":"PROJECTION"},{"sources":[75],"targets":[32],"expression":"NVL(sum(sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kuaibao),0)","edgeType":"PROJECTION"},{"sources":[76,77,78],"targets":[33],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.diaodu_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,79],"targets":[34],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.machine_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,80],"targets":[35],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.asn_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,81],"targets":[36],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null)) THEN (t_dws_video_chain_inter_daily.all_time) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,78],"targets":[37],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.diaodu_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,79],"targets":[38],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.machine_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,80],"targets":[39],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.asn_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[76,77,81],"targets":[40],"expression":"NVL(sum(CASE WHEN ((t_dws_video_chain_inter_daily.send_asn_time is not null and t_dws_video_chain_inter_daily.st_dispatched_rerun_time is null and t_dws_video_chain_inter_daily.all_time is not null)) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[82],"targets":[41],"expression":"NVL(sum(sng_mp_etldata.t_dws_video_chain_inter_daily.time),0)","edgeType":"PROJECTION"},{"sources":[82],"targets":[42],"expression":"NVL(sum(CASE WHEN (t_dws_video_chain_inter_daily.time is not null) THEN (1) ELSE (null) END),0)","edgeType":"PROJECTION"},{"sources":[],"targets":[43],"expression":"single_quote当日入库single_quote","edgeType":"PROJECTION"},{"sources":[83],"targets":[44],"expression":"UDFToString(send_audit_type)","edgeType":"PROJECTION"},{"sources":[84],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dws_video_chain_inter_daily.input_date = 20200601)","edgeType":"PREDICATE"},{"sources":[85,86,87,88],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dws_video_chain_inter_daily.rowkey = sanduan_tuijianchi_video_daily_new.rowkey AND t_dws_video_chain_inter_daily.rowkey = t_3t_lsa_video_center_hbase_merged_daily_migrate.rowkey AND t_dws_video_chain_inter_daily.rowkey = t_dim_fcc_b_video_rowkey_acc_d.rowkey)","edgeType":"PREDICATE"},{"sources":[89],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(sanduan_tuijianchi_video_daily_new.f_date = 20200601)","edgeType":"PREDICATE"},{"sources":[90],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date = 20200601)","edgeType":"PREDICATE"},{"sources":[91],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],"expression":"(t_dim_fcc_b_video_rowkey_acc_d.p_date = 20200601)","edgeType":"PREDICATE"}],"vertices":[{"id":0,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.ftime"},{"id":1,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.ftime_t"},{"id":2,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.is_75_tag"},{"id":3,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.p_overall_level"},{"id":4,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.content_overall_level"},{"id":5,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.has_qeh_src"},{"id":6,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.short_v"},{"id":7,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.src_ch"},{"id":8,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.crawl_src"},{"id":9,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.content_src"},{"id":10,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.union_chann"},{"id":11,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.union_sec_chann"},{"id":12,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.is_location"},{"id":13,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.input_cnt"},{"id":14,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_send"},{"id":15,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_duiji"},{"id":16,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_cnt"},{"id":17,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_pass"},{"id":18,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_filter"},{"id":19,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_send"},{"id":20,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_duiji"},{"id":21,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_cnt"},{"id":22,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_pass"},{"id":23,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_filter"},{"id":24,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.st_kd"},{"id":25,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.st_kd_history"},{"id":26,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_send"},{"id":27,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_pass"},{"id":28,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.pop_filter"},{"id":29,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.allowrecommend"},{"id":30,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_kandian"},{"id":31,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_liulanqi"},{"id":32,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.in_kuaibao"},{"id":33,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.diaodu_time"},{"id":34,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_time"},{"id":35,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_time"},{"id":36,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.all_time"},{"id":37,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.diaodu_time_cnt"},{"id":38,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.machine_time_cnt"},{"id":39,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.asn_time_cnt"},{"id":40,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.all_time_cnt"},{"id":41,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.time"},{"id":42,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.time_cnt"},{"id":43,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.data_type"},{"id":44,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_video_link_process_by_x_daily_process_caliber.send_audit_type"},{"id":45,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.overall_level"},{"id":46,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.content_overall_level"},{"id":47,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.has_qeh_src"},{"id":48,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.short_v"},{"id":49,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.content_type"},{"id":50,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_src"},{"id":51,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.crawl_src"},{"id":52,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.content_src"},{"id":53,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_chann"},{"id":54,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.union_sec_chann"},{"id":55,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.qeh_location_info"},{"id":56,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_cnt"},{"id":57,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_send"},{"id":58,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_duiji"},{"id":59,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_cnt"},{"id":60,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_pass"},{"id":61,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_filter"},{"id":62,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_send"},{"id":63,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_duiji"},{"id":64,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_cnt"},{"id":65,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_pass"},{"id":66,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_filter"},{"id":67,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd"},{"id":68,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_kd_history"},{"id":69,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_send"},{"id":70,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_pass"},{"id":71,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.pop_filter"},{"id":72,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.allowrecommend"},{"id":73,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kandian"},{"id":74,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_liulanqi"},{"id":75,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.in_kuaibao"},{"id":76,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.send_asn_time"},{"id":77,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.st_dispatched_rerun_time"},{"id":78,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.diaodu_time"},{"id":79,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.machine_time"},{"id":80,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.asn_time"},{"id":81,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.all_time"},{"id":82,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.time"},{"id":83,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.send_audit_type"},{"id":84,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.input_date"},{"id":85,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dws_video_chain_inter_daily.rowkey"},{"id":86,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.rowkey"},{"id":87,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.rowkey"},{"id":88,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.rowkey"},{"id":89,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.sanduan_tuijianchi_video_daily_new.f_date"},{"id":90,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_3t_lsa_video_center_hbase_merged_daily_migrate.imp_date"},{"id":91,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_dim_fcc_b_video_rowkey_acc_d.p_date"}]}'
    line2 = '{"version":"1.0","user":"qjiang","timestamp":1591607765,"duration":23399,"jobIds":["job_local305473006_0001","job_local1912265860_0002","job_local1781363076_0003","job_local1945274259_0004"],"engine":"mr","database":"sng_mediaaccount_app","hash":"fd7be1d97ab8dc41bc44716ff571aae4","queryText":"INSERT INTO kandian_mid_video_cinfo_d SELECT 20200607 AS ftime, rowkey , NVL(SUM(main_expose), 0) , NVL(SUM(tot_vv), 0) , NVL(SUM(tot_vv_incwesee), 0) , NVL(SUM(main_click), 0) , NVL(SUM(kddaily_expose), 0) , NVL(SUM(kddaily_click), 0) , NVL(SUM(tot_comment), 0) , NVL(SUM(dianzan), 0) , NVL(SUM(SHARE), 0) , NVL(SUM(biu_bak), 0) , NVL(SUM(accuse), 0) , NVL(SUM(collect), 0) , NVL(SUM(comment_zan), 0) , NVL(SUM(main_ratio), 0) , NVL(SUM(kddaily_ratio), 0) , NVL(SUM(videochn_expose), 0) , NVL(SUM(videochn_click), 0) , NVL(SUM(videochn_ratio), 0) , NVL(SUM(otherchn_expose), 0) , NVL(SUM(otherchn_click), 0) , NVL(SUM(otherchn_ratio), 0) , NVL(SUM(main_comment), 0) , NVL(SUM(sub_comment), 0) , NVL(SUM(main_comment_zan), 0) , NVL(SUM(sub_comment_zan), 0) , NVL(SUM(cancel_dianzan), 0) , NVL(SUM(onetothree_expose), 0) , NVL(SUM(onetothree_vv), 0) , NVL(SUM(mediaduration), 0) , NVL(SUM(watchduration), 0) , NVL(SUM(watchratio), 0) , NVL(SUM(valid_ratio), 0) , NVL(SUM(all_neg_fback), 0) , NVL(SUM(onetothree_neg_fback), 0) , NVL(SUM(feeds_neg_fback), 0) , NVL(SUM(valid_vv), 0) AS valid_vv FROM ( SELECT a.* FROM ( SELECT rowkey, SUM(main_expose) AS main_expose, SUM(main_click) AS main_click , SUM(main_ratio) AS main_ratio, SUM(kddaily_expose) AS kddaily_expose , SUM(kddaily_click) AS kddaily_click, SUM(kddaily_ratio) AS kddaily_ratio , SUM(videochn_expose) AS videochn_expose, SUM(videochn_click) AS videochn_click , SUM(videochn_ratio) AS videochn_ratio, SUM(otherchn_expose) AS otherchn_expose , SUM(otherchn_click) AS otherchn_click, SUM(otherchn_ratio) AS otherchn_ratio , SUM(comment_zan) AS comment_zan, SUM(main_comment) AS main_comment , SUM(sub_comment) AS sub_comment, SUM(tot_comment) AS tot_comment , SUM(main_comment_zan) AS main_comment_zan, SUM(sub_comment_zan) AS sub_comment_zan , NULL AS onetothree_expose, NULL AS onetothree_vv, NULL AS tot_vv, NULL AS tot_vv_incwesee, NULL AS mediaduration , NULL AS watchduration, NULL AS watchratio, NULL AS valid_ratio, NULL AS dianzan, NULL AS cancel_dianzan , SUM(biu_bak) AS biu_bak, NULL AS SHARE, NULL AS collect , NULL AS accuse, NULL AS all_neg_fback, NULL AS onetothree_neg_fback, NULL AS feeds_neg_fback, NULL AS valid_vv FROM ( SELECT rowkey, main_expose, main_click, main_ratio, kddaily_expose , kddaily_click, kddaily_ratio, videochn_expose, videochn_click, videochn_ratio , otherchn_expose, otherchn_click, otherchn_ratio, NULL AS comment_zan, NULL AS main_comment , NULL AS sub_comment, NULL AS tot_comment, NULL AS main_comment_zan, NULL AS sub_comment_zan, NULL AS biu_bak , NULL AS new_ribao_expose, NULL AS new_ribao_click FROM kandian_ods_all_feeds_expclick_d WHERE ftime = 20200607 UNION ALL SELECT rowkey, NULL AS main_expose, NULL AS main_click, NULL AS main_ratio, NULL AS kddaily_expose , NULL AS kddaily_click, NULL AS kddaily_ratio, NULL AS videochn_expose, NULL AS videochn_click, NULL AS videochn_ratio , NULL AS otherchn_expose, NULL AS otherchn_click, NULL AS otherchn_ratio, comment_zan, main_comment , sub_comment, tot_comment, main_comment_zan, sub_comment_zan, NULL AS biu_bak , NULL AS new_ribao_expose, NULL AS new_ribao_click FROM kandian_ods_all_comment_comzan_d WHERE ftime = 20200607 UNION ALL SELECT rowkey, NULL AS main_expose, NULL AS main_click, NULL AS main_ratio, NULL AS kddaily_expose , NULL AS kddaily_click, NULL AS kddaily_ratio, NULL AS videochn_expose, NULL AS videochn_click, NULL AS videochn_ratio , NULL AS otherchn_expose, NULL AS otherchn_click, NULL AS otherchn_ratio, NULL AS comment_zan, NULL AS main_comment , NULL AS sub_comment, NULL AS tot_comment, NULL AS main_comment_zan, NULL AS sub_comment_zan, publish_biu AS biu_bak , NULL AS new_ribao_expose, NULL AS new_ribao_click FROM kandian_ods_all_biu_d WHERE ftime = 20200607 UNION ALL SELECT rowkey, NULL AS main_expose, NULL AS main_click, NULL AS main_ratio, NULL AS kddaily_expose , NULL AS kddaily_click, NULL AS kddaily_ratio, NULL AS videochn_expose, NULL AS videochn_click, NULL AS videochn_ratio , NULL AS otherchn_expose, NULL AS otherchn_click, NULL AS otherchn_ratio, NULL AS comment_zan, NULL AS main_comment , NULL AS sub_comment, NULL AS tot_comment, NULL AS main_comment_zan, NULL AS sub_comment_zan, NULL AS biu_bak , new_ribao_expose, new_ribao_click FROM kandian_ods_all_ribao_feeds_d WHERE ftime = 20200607 ) t1 GROUP BY rowkey ) a JOIN ( SELECT rowkey FROM t_kd_video_info WHERE f_date = 20200607 ) b ON a.rowkey = b.rowkey UNION ALL SELECT rowkey, NULL AS main_expose, NULL AS main_click, NULL AS main_ratio, NULL AS kddaily_expose , NULL AS kddaily_click, NULL AS kddaily_ratio, NULL AS videochn_expose, NULL AS videochn_click, NULL AS videochn_ratio , NULL AS otherchn_expose, NULL AS otherchn_click, NULL AS otherchn_ratio, NULL AS comment_zan, NULL AS main_comment , NULL AS sub_comment, NULL AS tot_comment, NULL AS main_comment_zan, NULL AS sub_comment_zan, onetothree_expose , onetothree_vv, tot_vv, tot_vv_incwesee, mediaduration, watchduration , watchratio, valid_ratio, NULL AS dianzan, NULL AS cancel_dianzan, NULL AS biu_bak , NULL AS SHARE, NULL AS collect, NULL AS accuse, NULL AS all_neg_fback, NULL AS onetothree_neg_fback , NULL AS feeds_neg_fback, valid_vv FROM kandian_ods_video_core_d WHERE ftime = 20200607 UNION ALL SELECT rowkey, NULL AS main_expose, NULL AS main_click, NULL AS main_ratio, NULL AS kddaily_expose , NULL AS kddaily_click, NULL AS kddaily_ratio, NULL AS videochn_expose, NULL AS videochn_click, NULL AS videochn_ratio , NULL AS otherchn_expose, NULL AS otherchn_click, NULL AS otherchn_ratio, NULL AS comment_zan, NULL AS main_comment , NULL AS sub_comment, NULL AS tot_comment, NULL AS main_comment_zan, NULL AS sub_comment_zan, NULL AS onetothree_expose , NULL AS onetothree_vv, NULL AS tot_vv, NULL AS tot_vv_incwesee, NULL AS mediaduration, NULL AS watchduration , NULL AS watchratio, NULL AS valid_ratio, dianzan, cancel_dianzan, biu_bak , SHARE, collect, accuse, NULL AS all_neg_fback, NULL AS onetothree_neg_fback , NULL AS feeds_neg_fback, NULL AS valid_vv FROM kandian_ods_video_interactive_d WHERE ftime = 20200607 UNION ALL SELECT rowkey, NULL AS main_expose, NULL AS main_click, NULL AS main_ratio, NULL AS kddaily_expose , NULL AS kddaily_click, NULL AS kddaily_ratio, NULL AS videochn_expose, NULL AS videochn_click, NULL AS videochn_ratio , NULL AS otherchn_expose, NULL AS otherchn_click, NULL AS otherchn_ratio, NULL AS comment_zan, NULL AS main_comment , NULL AS sub_comment, NULL AS tot_comment, NULL AS main_comment_zan, NULL AS sub_comment_zan, NULL AS onetothree_expose , NULL AS onetothree_vv, NULL AS tot_vv, NULL AS tot_vv_incwesee, NULL AS mediaduration, NULL AS watchduration , NULL AS watchratio, NULL AS valid_ratio, NULL AS dianzan, NULL AS cancel_dianzan, NULL AS biu_bak , NULL AS SHARE, NULL AS collect, NULL AS accuse, all_neg_fback, onetothree_neg_fback , feeds_neg_fback, NULL AS valid_vv FROM kandian_ods_video_neg_feedback_d WHERE ftime = 20200607 ) t3 GROUP BY rowkey","edges":[{"sources":[],"targets":[0],"expression":"VURGVG9Mb25nKDIwMjAwNjA3KQ==","edgeType":"PROJECTION"},{"sources":[38,39,40,41,42,43,44],"targets":[1],"expression":"cm93a2V5","edgeType":"PROJECTION"},{"sources":[45],"targets":[2],"expression":"TlZMKHN1bShtYWluX2V4cG9zZSksMCk=","edgeType":"PROJECTION"},{"sources":[46],"targets":[3],"expression":"TlZMKHN1bSh0b3RfdnYpLDAp","edgeType":"PROJECTION"},{"sources":[47],"targets":[4],"expression":"TlZMKHN1bSh0b3RfdnZfaW5jd2VzZWUpLDAp","edgeType":"PROJECTION"},{"sources":[48],"targets":[5],"expression":"TlZMKHN1bShtYWluX2NsaWNrKSwwKQ==","edgeType":"PROJECTION"},{"sources":[49],"targets":[6],"expression":"TlZMKHN1bShrZGRhaWx5X2V4cG9zZSksMCk=","edgeType":"PROJECTION"},{"sources":[50],"targets":[7],"expression":"TlZMKHN1bShrZGRhaWx5X2NsaWNrKSwwKQ==","edgeType":"PROJECTION"},{"sources":[51],"targets":[8],"expression":"TlZMKHN1bSh0b3RfY29tbWVudCksMCk=","edgeType":"PROJECTION"},{"sources":[52],"targets":[9],"expression":"TlZMKHN1bShkaWFuemFuKSwwKQ==","edgeType":"PROJECTION"},{"sources":[53],"targets":[10],"expression":"TlZMKHN1bShzaGFyZSksMCk=","edgeType":"PROJECTION"},{"sources":[54,55],"targets":[11],"expression":"TlZMKHN1bShiaXVfYmFrKSwwKQ==","edgeType":"PROJECTION"},{"sources":[56],"targets":[12],"expression":"TlZMKHN1bShhY2N1c2UpLDAp","edgeType":"PROJECTION"},{"sources":[57],"targets":[13],"expression":"TlZMKHN1bShjb2xsZWN0KSwwKQ==","edgeType":"PROJECTION"},{"sources":[58],"targets":[14],"expression":"TlZMKHN1bShjb21tZW50X3phbiksMCk=","edgeType":"PROJECTION"},{"sources":[59],"targets":[15],"expression":"TlZMKHN1bShtYWluX3JhdGlvKSwwKQ==","edgeType":"PROJECTION"},{"sources":[60],"targets":[16],"expression":"TlZMKHN1bShrZGRhaWx5X3JhdGlvKSwwKQ==","edgeType":"PROJECTION"},{"sources":[61],"targets":[17],"expression":"TlZMKHN1bSh2aWRlb2Nobl9leHBvc2UpLDAp","edgeType":"PROJECTION"},{"sources":[62],"targets":[18],"expression":"TlZMKHN1bSh2aWRlb2Nobl9jbGljayksMCk=","edgeType":"PROJECTION"},{"sources":[63],"targets":[19],"expression":"TlZMKHN1bSh2aWRlb2Nobl9yYXRpbyksMCk=","edgeType":"PROJECTION"},{"sources":[64],"targets":[20],"expression":"TlZMKHN1bShvdGhlcmNobl9leHBvc2UpLDAp","edgeType":"PROJECTION"},{"sources":[65],"targets":[21],"expression":"TlZMKHN1bShvdGhlcmNobl9jbGljayksMCk=","edgeType":"PROJECTION"},{"sources":[66],"targets":[22],"expression":"TlZMKHN1bShvdGhlcmNobl9yYXRpbyksMCk=","edgeType":"PROJECTION"},{"sources":[67],"targets":[23],"expression":"TlZMKHN1bShtYWluX2NvbW1lbnQpLDAp","edgeType":"PROJECTION"},{"sources":[68],"targets":[24],"expression":"TlZMKHN1bShzdWJfY29tbWVudCksMCk=","edgeType":"PROJECTION"},{"sources":[69],"targets":[25],"expression":"TlZMKHN1bShtYWluX2NvbW1lbnRfemFuKSwwKQ==","edgeType":"PROJECTION"},{"sources":[70],"targets":[26],"expression":"TlZMKHN1bShzdWJfY29tbWVudF96YW4pLDAp","edgeType":"PROJECTION"},{"sources":[71],"targets":[27],"expression":"TlZMKHN1bShjYW5jZWxfZGlhbnphbiksMCk=","edgeType":"PROJECTION"},{"sources":[72],"targets":[28],"expression":"TlZMKHN1bShvbmV0b3RocmVlX2V4cG9zZSksMCk=","edgeType":"PROJECTION"},{"sources":[73],"targets":[29],"expression":"TlZMKHN1bShvbmV0b3RocmVlX3Z2KSwwKQ==","edgeType":"PROJECTION"},{"sources":[74],"targets":[30],"expression":"TlZMKHN1bShtZWRpYWR1cmF0aW9uKSwwKQ==","edgeType":"PROJECTION"},{"sources":[75],"targets":[31],"expression":"TlZMKHN1bSh3YXRjaGR1cmF0aW9uKSwwKQ==","edgeType":"PROJECTION"},{"sources":[76],"targets":[32],"expression":"TlZMKHN1bSh3YXRjaHJhdGlvKSwwKQ==","edgeType":"PROJECTION"},{"sources":[77],"targets":[33],"expression":"TlZMKHN1bSh2YWxpZF9yYXRpbyksMCk=","edgeType":"PROJECTION"},{"sources":[78],"targets":[34],"expression":"TlZMKHN1bShhbGxfbmVnX2ZiYWNrKSwwKQ==","edgeType":"PROJECTION"},{"sources":[79],"targets":[35],"expression":"TlZMKHN1bShvbmV0b3RocmVlX25lZ19mYmFjayksMCk=","edgeType":"PROJECTION"},{"sources":[80],"targets":[36],"expression":"TlZMKHN1bShmZWVkc19uZWdfZmJhY2spLDAp","edgeType":"PROJECTION"},{"sources":[81],"targets":[37],"expression":"TlZMKHN1bSh2YWxpZF92diksMCk=","edgeType":"PROJECTION"},{"sources":[82,38],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"expression":"KChrYW5kaWFuX29kc19hbGxfZmVlZHNfZXhwY2xpY2tfZC5mdGltZSA9IDIwMjAwNjA3KSBhbmQg\ra2FuZGlhbl9vZHNfYWxsX2ZlZWRzX2V4cGNsaWNrX2Qucm93a2V5IGlzIG5vdCBudWxsKQ==","edgeType":"PREDICATE"},{"sources":[83,39],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"expression":"KChrYW5kaWFuX29kc19hbGxfY29tbWVudF9jb216YW5fZC5mdGltZSA9IDIwMjAwNjA3KSBhbmQg\ra2FuZGlhbl9vZHNfYWxsX2NvbW1lbnRfY29temFuX2Qucm93a2V5IGlzIG5vdCBudWxsKQ==","edgeType":"PREDICATE"},{"sources":[84,40],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"expression":"KChrYW5kaWFuX29kc19hbGxfYml1X2QuZnRpbWUgPSAyMDIwMDYwNykgYW5kIGthbmRpYW5fb2Rz\rX2FsbF9iaXVfZC5yb3drZXkgaXMgbm90IG51bGwp","edgeType":"PREDICATE"},{"sources":[85,41],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"expression":"KChrYW5kaWFuX29kc19hbGxfcmliYW9fZmVlZHNfZC5mdGltZSA9IDIwMjAwNjA3KSBhbmQga2Fu\rZGlhbl9vZHNfYWxsX3JpYmFvX2ZlZWRzX2Qucm93a2V5IGlzIG5vdCBudWxsKQ==","edgeType":"PREDICATE"},{"sources":[38,39,40,41,86],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"expression":"KHJvd2tleSA9IHRfa2RfdmlkZW9faW5mby5yb3drZXkp","edgeType":"PREDICATE"},{"sources":[87,86],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"expression":"KCh0X2tkX3ZpZGVvX2luZm8uZl9kYXRlID0gMjAyMDA2MDcpIGFuZCB0X2tkX3ZpZGVvX2luZm8u\rcm93a2V5IGlzIG5vdCBudWxsKQ==","edgeType":"PREDICATE"},{"sources":[88],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"expression":"KGthbmRpYW5fb2RzX3ZpZGVvX2NvcmVfZC5mdGltZSA9IDIwMjAwNjA3KQ==","edgeType":"PREDICATE"},{"sources":[89],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"expression":"KGthbmRpYW5fb2RzX3ZpZGVvX2ludGVyYWN0aXZlX2QuZnRpbWUgPSAyMDIwMDYwNyk=","edgeType":"PREDICATE"},{"sources":[90],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"expression":"KGthbmRpYW5fb2RzX3ZpZGVvX25lZ19mZWVkYmFja19kLmZ0aW1lID0gMjAyMDA2MDcp","edgeType":"PREDICATE"}],"vertices":[{"id":0,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.ftime"},{"id":1,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.rowkey"},{"id":2,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.baoguang_cnt"},{"id":3,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.vv"},{"id":4,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.vv_inc_wesee"},{"id":5,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.main_click"},{"id":6,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.kddaily_expose"},{"id":7,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.kddaily_click"},{"id":8,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.comment_cnt"},{"id":9,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.dianzan_cnt"},{"id":10,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.share_cnt"},{"id":11,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.biu_cnt"},{"id":12,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.accuse_cnt"},{"id":13,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.collect_cnt"},{"id":14,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.comment_zan_cnt"},{"id":15,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.main_ratio"},{"id":16,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.kddaily_ratio"},{"id":17,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.videochn_expose"},{"id":18,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.videochn_click"},{"id":19,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.videochn_ratio"},{"id":20,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.otherchn_expose"},{"id":21,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.otherchn_click"},{"id":22,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.otherchn_ratio"},{"id":23,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.main_comment"},{"id":24,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.sub_comment"},{"id":25,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.main_comment_zan"},{"id":26,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.sub_comment_zan"},{"id":27,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.cancel_dianzan"},{"id":28,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.onetothree_expose"},{"id":29,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.onetothree_vv"},{"id":30,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.mediaduration"},{"id":31,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.watchduration"},{"id":32,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.watchratio"},{"id":33,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.valid_ratio"},{"id":34,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.all_neg_fback"},{"id":35,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.onetothree_neg_fback"},{"id":36,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.feeds_neg_fback"},{"id":37,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.valid_vv"},{"id":38,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.rowkey"},{"id":39,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_comment_comzan_d.rowkey"},{"id":40,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_biu_d.rowkey"},{"id":41,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_ribao_feeds_d.rowkey"},{"id":42,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.rowkey"},{"id":43,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_interactive_d.rowkey"},{"id":44,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_neg_feedback_d.rowkey"},{"id":45,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.main_expose"},{"id":46,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.tot_vv"},{"id":47,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.tot_vv_incwesee"},{"id":48,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.main_click"},{"id":49,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.kddaily_expose"},{"id":50,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.kddaily_click"},{"id":51,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_comment_comzan_d.tot_comment"},{"id":52,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_interactive_d.dianzan"},{"id":53,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_interactive_d.share"},{"id":54,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_biu_d.publish_biu"},{"id":55,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_interactive_d.biu_bak"},{"id":56,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_interactive_d.accuse"},{"id":57,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_interactive_d.collect"},{"id":58,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_comment_comzan_d.comment_zan"},{"id":59,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.main_ratio"},{"id":60,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.kddaily_ratio"},{"id":61,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.videochn_expose"},{"id":62,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.videochn_click"},{"id":63,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.videochn_ratio"},{"id":64,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.otherchn_expose"},{"id":65,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.otherchn_click"},{"id":66,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.otherchn_ratio"},{"id":67,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_comment_comzan_d.main_comment"},{"id":68,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_comment_comzan_d.sub_comment"},{"id":69,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_comment_comzan_d.main_comment_zan"},{"id":70,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_comment_comzan_d.sub_comment_zan"},{"id":71,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_interactive_d.cancel_dianzan"},{"id":72,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.onetothree_expose"},{"id":73,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.onetothree_vv"},{"id":74,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.mediaduration"},{"id":75,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.watchduration"},{"id":76,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.watchratio"},{"id":77,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.valid_ratio"},{"id":78,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_neg_feedback_d.all_neg_fback"},{"id":79,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_neg_feedback_d.onetothree_neg_fback"},{"id":80,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_neg_feedback_d.feeds_neg_fback"},{"id":81,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.valid_vv"},{"id":82,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_feeds_expclick_d.ftime"},{"id":83,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_comment_comzan_d.ftime"},{"id":84,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_biu_d.ftime"},{"id":85,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_all_ribao_feeds_d.ftime"},{"id":86,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.t_kd_video_info.rowkey"},{"id":87,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.t_kd_video_info.f_date"},{"id":88,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_core_d.ftime"},{"id":89,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_interactive_d.ftime"},{"id":90,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_ods_video_neg_feedback_d.ftime"}]}'
    line3 = '{"version":"1.0","user":"qjiang","timestamp":1591611991,"duration":15555,"jobIds":["job_local1470743835_0006"],"engine":"mr","database":"sng_mediaaccount_app","hash":"71adbe4ded9e628f1bd7dabdc911de2d","queryText":"INSERT INTO kandian_video_medium_full_info_d SELECT 20200607 AS ftime, aa.rowkey, bb.puin , NVL(bb.short_v, 0) AS video_type, aa.video_vv , aa.valid_vv, aa.baoguang_cnt, aa.dianzan_cnt, aa.share_cnt, aa.biu_cnt , bb.bid, bb.puin_name, bb.upt, bb.input_ts, bb.asn_enable_time , bb.kd_chann_new, bb.kd_sec_chann_new, bb.kd_trd_chann_new, bb.time, bb.ex_is_firstpubed , bb.ex_is_ori, bb.ex_is_exclusive, bb.star_grade, bb.ex_is_recom_edit, bb.ex_explosions , bb.st_vert, bb.platform_src, bb.st_src, bb.crawl_src, bb.kd_tag , bb.st_txt_vid, bb.st_txt, bb.title AS title, bb.st_kd, bb.st_sync , bb.ex_premium, bb.ex_is_choice, bb.ex_is_day_better, bb.output_ts, aa.vv_weishi , aa.comment_cnt, url, main_click, kddaily_expose, kddaily_click , videochn_expose, videochn_click, otherchn_expose, otherchn_click, main_comment , sub_comment, main_comment_zan, sub_comment_zan, onetothree_expose, onetothree_vv , tot_expose, watchduration, union_chann, union_chann_id, union_sec_chann , union_sec_chann_id, union_trd_chann, union_trd_chann_id, union_tag, union_tag_id , tot_watch_duration FROM ( SELECT rowkey, vv AS video_vv, vv_inc_wesee AS vv_weishi, valid_vv, baoguang_cnt , dianzan_cnt, share_cnt, biu_cnt, comment_cnt, main_click , kddaily_expose, kddaily_click, videochn_expose, videochn_click, otherchn_expose , otherchn_click, main_comment, sub_comment, main_comment_zan, sub_comment_zan , onetothree_expose, onetothree_vv , nvl(baoguang_cnt, 0) + nvl(kddaily_expose, 0) + nvl(videochn_expose, 0) + nvl(otherchn_expose, 0) + nvl(onetothree_expose, 0) AS tot_expose , watchduration, watchduration * vv / 1000 AS tot_watch_duration FROM kandian_mid_video_cinfo_d WHERE ftime = 20200607 ) aa LEFT JOIN ( SELECT rowkey, puin, bid , regexp_replace(puin_name, single_quoteregregsingle_quote, single_quotesingle_quote) AS puin_name , short_v, upt, input_ts, asn_enable_time, kd_chann_new , kd_sec_chann_new, kd_trd_chann_new, time, ex_is_firstpubed, ex_is_ori , ex_is_exclusive, star_grade, ex_is_recom_edit, ex_explosions, st_vert , platform_src, st_src, crawl_src, kd_tag, st_txt_vid , st_txt, regexp_replace(CAST(unbase64(title) AS string), single_quoteregregsingle_quote, single_quotesingle_quote) AS title , st_kd, st_sync, ex_premium, ex_is_choice, ex_is_day_better , output_ts, url, union_chann, union_chann_id, union_sec_chann , union_sec_chann_id, union_trd_chann, union_trd_chann_id, union_tag, union_tag_id FROM sng_mp_etldata.t_kd_video_info WHERE f_date = 20200607 ) bb ON aa.rowkey = bb.rowkey","edges":[{"sources":[],"targets":[0],"expression":"VURGVG9Mb25nKDIwMjAwNjA3KQ==","edgeType":"PROJECTION"},{"sources":[66],"targets":[1],"edgeType":"PROJECTION"},{"sources":[67],"targets":[2],"edgeType":"PROJECTION"},{"sources":[68],"targets":[3],"expression":"TlZMKHRfa2RfdmlkZW9faW5mby5zaG9ydF92LDAp","edgeType":"PROJECTION"},{"sources":[69],"targets":[4],"edgeType":"PROJECTION"},{"sources":[70],"targets":[5],"edgeType":"PROJECTION"},{"sources":[71],"targets":[6],"edgeType":"PROJECTION"},{"sources":[72],"targets":[7],"edgeType":"PROJECTION"},{"sources":[73],"targets":[8],"edgeType":"PROJECTION"},{"sources":[74],"targets":[9],"edgeType":"PROJECTION"},{"sources":[75],"targets":[10],"edgeType":"PROJECTION"},{"sources":[76],"targets":[11],"expression":"cmVnZXhwX3JlcGxhY2UodF9rZF92aWRlb19pbmZvLnB1aW5fbmFtZSwgJ1sJfAp8DV0rJywgJycp","edgeType":"PROJECTION"},{"sources":[77],"targets":[12],"edgeType":"PROJECTION"},{"sources":[78],"targets":[13],"edgeType":"PROJECTION"},{"sources":[79],"targets":[14],"edgeType":"PROJECTION"},{"sources":[80],"targets":[15],"edgeType":"PROJECTION"},{"sources":[81],"targets":[16],"edgeType":"PROJECTION"},{"sources":[82],"targets":[17],"edgeType":"PROJECTION"},{"sources":[83],"targets":[18],"edgeType":"PROJECTION"},{"sources":[84],"targets":[19],"edgeType":"PROJECTION"},{"sources":[85],"targets":[20],"edgeType":"PROJECTION"},{"sources":[86],"targets":[21],"edgeType":"PROJECTION"},{"sources":[87],"targets":[22],"edgeType":"PROJECTION"},{"sources":[88],"targets":[23],"edgeType":"PROJECTION"},{"sources":[89],"targets":[24],"edgeType":"PROJECTION"},{"sources":[90],"targets":[25],"edgeType":"PROJECTION"},{"sources":[91],"targets":[26],"edgeType":"PROJECTION"},{"sources":[92],"targets":[27],"edgeType":"PROJECTION"},{"sources":[93],"targets":[28],"edgeType":"PROJECTION"},{"sources":[94],"targets":[29],"edgeType":"PROJECTION"},{"sources":[95],"targets":[30],"edgeType":"PROJECTION"},{"sources":[96],"targets":[31],"edgeType":"PROJECTION"},{"sources":[97],"targets":[32],"expression":"cmVnZXhwX3JlcGxhY2UoVURGVG9TdHJpbmcodW5iYXNlNjQodF9rZF92aWRlb19pbmZvLnRpdGxl\r\nKSksICdbCXwKfA1dKycsICcnKQ==","edgeType":"PROJECTION"},{"sources":[98],"targets":[33],"edgeType":"PROJECTION"},{"sources":[99],"targets":[34],"edgeType":"PROJECTION"},{"sources":[100],"targets":[35],"edgeType":"PROJECTION"},{"sources":[101],"targets":[36],"edgeType":"PROJECTION"},{"sources":[102],"targets":[37],"edgeType":"PROJECTION"},{"sources":[103],"targets":[38],"edgeType":"PROJECTION"},{"sources":[104],"targets":[39],"edgeType":"PROJECTION"},{"sources":[105],"targets":[40],"edgeType":"PROJECTION"},{"sources":[106],"targets":[41],"edgeType":"PROJECTION"},{"sources":[107],"targets":[42],"edgeType":"PROJECTION"},{"sources":[108],"targets":[43],"edgeType":"PROJECTION"},{"sources":[109],"targets":[44],"edgeType":"PROJECTION"},{"sources":[110],"targets":[45],"edgeType":"PROJECTION"},{"sources":[111],"targets":[46],"edgeType":"PROJECTION"},{"sources":[112],"targets":[47],"edgeType":"PROJECTION"},{"sources":[113],"targets":[48],"edgeType":"PROJECTION"},{"sources":[114],"targets":[49],"edgeType":"PROJECTION"},{"sources":[115],"targets":[50],"edgeType":"PROJECTION"},{"sources":[116],"targets":[51],"edgeType":"PROJECTION"},{"sources":[117],"targets":[52],"edgeType":"PROJECTION"},{"sources":[118],"targets":[53],"edgeType":"PROJECTION"},{"sources":[119],"targets":[54],"edgeType":"PROJECTION"},{"sources":[71,108,110,112,118],"targets":[55],"expression":"KCgoKE5WTChrYW5kaWFuX21pZF92aWRlb19jaW5mb19kLmJhb2d1YW5nX2NudCwwKSArIE5WTChr\r\nYW5kaWFuX21pZF92aWRlb19jaW5mb19kLmtkZGFpbHlfZXhwb3NlLDApKSArIE5WTChrYW5kaWFu\r\nX21pZF92aWRlb19jaW5mb19kLnZpZGVvY2huX2V4cG9zZSwwKSkgKyBOVkwoa2FuZGlhbl9taWRf\r\ndmlkZW9fY2luZm9fZC5vdGhlcmNobl9leHBvc2UsMCkpICsgTlZMKGthbmRpYW5fbWlkX3ZpZGVv\r\nX2NpbmZvX2Qub25ldG90aHJlZV9leHBvc2UsMCkp","edgeType":"PROJECTION"},{"sources":[120],"targets":[56],"edgeType":"PROJECTION"},{"sources":[121],"targets":[57],"edgeType":"PROJECTION"},{"sources":[122],"targets":[58],"edgeType":"PROJECTION"},{"sources":[123],"targets":[59],"edgeType":"PROJECTION"},{"sources":[124],"targets":[60],"edgeType":"PROJECTION"},{"sources":[125],"targets":[61],"edgeType":"PROJECTION"},{"sources":[126],"targets":[62],"edgeType":"PROJECTION"},{"sources":[127],"targets":[63],"edgeType":"PROJECTION"},{"sources":[128],"targets":[64],"edgeType":"PROJECTION"},{"sources":[120,69],"targets":[65],"expression":"KChrYW5kaWFuX21pZF92aWRlb19jaW5mb19kLndhdGNoZHVyYXRpb24gKiBVREZUb0RvdWJsZShr\r\nYW5kaWFuX21pZF92aWRlb19jaW5mb19kLnZ2KSkgLyAxMDAwLjAp","edgeType":"PROJECTION"},{"sources":[129],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65],"expression":"KGthbmRpYW5fbWlkX3ZpZGVvX2NpbmZvX2QuZnRpbWUgPSAyMDIwMDYwNyk=","edgeType":"PREDICATE"},{"sources":[66,130],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65],"expression":"KGthbmRpYW5fbWlkX3ZpZGVvX2NpbmZvX2Qucm93a2V5ID0gdF9rZF92aWRlb19pbmZvLnJvd2tl\r\neSk=","edgeType":"PREDICATE"},{"sources":[131],"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65],"expression":"KHRfa2RfdmlkZW9faW5mby5mX2RhdGUgPSAyMDIwMDYwNyk=","edgeType":"PREDICATE"}],"vertices":[{"id":0,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.ftime"},{"id":1,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.rowkey"},{"id":2,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.puin"},{"id":3,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.video_type"},{"id":4,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.video_vv"},{"id":5,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.valid_vv"},{"id":6,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.baoguang_cnt"},{"id":7,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.dianzan_cnt"},{"id":8,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.share_cnt"},{"id":9,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.biu_cnt"},{"id":10,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.bid"},{"id":11,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.puin_name"},{"id":12,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.upt"},{"id":13,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.input_ts"},{"id":14,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.asn_enable_time"},{"id":15,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.kd_chann"},{"id":16,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.kd_sec_chann"},{"id":17,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.kd_trd_chann"},{"id":18,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.time"},{"id":19,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.ex_is_fristpushed"},{"id":20,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.ex_is_ori"},{"id":21,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.ex_is_exclusive"},{"id":22,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.star_grade"},{"id":23,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.ex_is_recom_edit"},{"id":24,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.ex_explosions"},{"id":25,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.st_vert"},{"id":26,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.platform_src"},{"id":27,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.st_src"},{"id":28,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.crawl_src"},{"id":29,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.kd_tag"},{"id":30,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.st_txt_vid"},{"id":31,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.st_txt"},{"id":32,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.title"},{"id":33,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.st_kd"},{"id":34,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.st_sync"},{"id":35,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.ex_premium"},{"id":36,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.ex_is_choice"},{"id":37,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.ex_is_day_better"},{"id":38,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.output_ts"},{"id":39,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.vv_weishi"},{"id":40,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.comment_cnt"},{"id":41,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.url"},{"id":42,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.main_click"},{"id":43,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.kddaily_expose"},{"id":44,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.kddaily_click"},{"id":45,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.videochn_expose"},{"id":46,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.videochn_click"},{"id":47,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.otherchn_expose"},{"id":48,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.otherchn_click"},{"id":49,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.main_comment"},{"id":50,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.sub_comment"},{"id":51,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.main_comment_zan"},{"id":52,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.sub_comment_zan"},{"id":53,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.onetothree_expose"},{"id":54,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.onetothree_vv"},{"id":55,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.tot_expose"},{"id":56,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.watchduration"},{"id":57,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.union_chann"},{"id":58,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.union_chann_id"},{"id":59,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.union_sec_chann"},{"id":60,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.union_sec_chann_id"},{"id":61,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.union_trd_chann"},{"id":62,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.union_trd_chann_id"},{"id":63,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.union_tag"},{"id":64,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.union_tag_id"},{"id":65,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_video_medium_full_info_d.tot_watch_duration"},{"id":66,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.rowkey"},{"id":67,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.puin"},{"id":68,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.short_v"},{"id":69,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.vv"},{"id":70,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.valid_vv"},{"id":71,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.baoguang_cnt"},{"id":72,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.dianzan_cnt"},{"id":73,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.share_cnt"},{"id":74,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.biu_cnt"},{"id":75,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.bid"},{"id":76,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.puin_name"},{"id":77,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.upt"},{"id":78,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.input_ts"},{"id":79,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.asn_enable_time"},{"id":80,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.kd_chann_new"},{"id":81,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.kd_sec_chann_new"},{"id":82,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.kd_trd_chann_new"},{"id":83,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.time"},{"id":84,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.ex_is_firstpubed"},{"id":85,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.ex_is_ori"},{"id":86,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.ex_is_exclusive"},{"id":87,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.star_grade"},{"id":88,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.ex_is_recom_edit"},{"id":89,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.ex_explosions"},{"id":90,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.st_vert"},{"id":91,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.platform_src"},{"id":92,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.st_src"},{"id":93,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.crawl_src"},{"id":94,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.kd_tag"},{"id":95,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.st_txt_vid"},{"id":96,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.st_txt"},{"id":97,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.title"},{"id":98,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.st_kd"},{"id":99,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.st_sync"},{"id":100,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.ex_premium"},{"id":101,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.ex_is_choice"},{"id":102,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.ex_is_day_better"},{"id":103,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.output_ts"},{"id":104,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.vv_inc_wesee"},{"id":105,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.comment_cnt"},{"id":106,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.url"},{"id":107,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.main_click"},{"id":108,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.kddaily_expose"},{"id":109,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.kddaily_click"},{"id":110,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.videochn_expose"},{"id":111,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.videochn_click"},{"id":112,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.otherchn_expose"},{"id":113,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.otherchn_click"},{"id":114,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.main_comment"},{"id":115,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.sub_comment"},{"id":116,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.main_comment_zan"},{"id":117,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.sub_comment_zan"},{"id":118,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.onetothree_expose"},{"id":119,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.onetothree_vv"},{"id":120,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.watchduration"},{"id":121,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.union_chann"},{"id":122,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.union_chann_id"},{"id":123,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.union_sec_chann"},{"id":124,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.union_sec_chann_id"},{"id":125,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.union_trd_chann"},{"id":126,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.union_trd_chann_id"},{"id":127,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.union_tag"},{"id":128,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.union_tag_id"},{"id":129,"vertexType":"COLUMN","vertexId":"sng_mediaaccount_app.kandian_mid_video_cinfo_d.ftime"},{"id":130,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.rowkey"},{"id":131,"vertexType":"COLUMN","vertexId":"sng_mp_etldata.t_kd_video_info.f_date"}]}'


    line = line3
    print(f"{line}:\n\t")

    print("-" * 160)
    process_lineage_hook_info(line)
    sys.exit(0)


if __name__ == '__main__':
    main()
